<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="18033" />


<title>A-18033</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">A-18033</h1>
<h4 class="author"><em>18033</em></h4>
<h4 class="date"><em>2019.01.10</em></h4>



<div id="h1-a-18033-2018-09-14" class="section level2">
<h2>H1 A-18033-2018-09-14</h2>
</div>
<div id="r-markdown-examples" class="section level2">
<h2>R Markdown Examples</h2>
</div>
<div id="example-1-random" class="section level2">
<h2>Example 1 : Random</h2>
<p>100 random number from normal ,mean = 0, sigma = 1</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">1</span>)
x</code></pre></div>
<pre><code>##   [1] -0.626453811  0.183643324 -0.835628612  1.595280802  0.329507772
##   [6] -0.820468384  0.487429052  0.738324705  0.575781352 -0.305388387
##  [11]  1.511781168  0.389843236 -0.621240581 -2.214699887  1.124930918
##  [16] -0.044933609 -0.016190263  0.943836211  0.821221195  0.593901321
##  [21]  0.918977372  0.782136301  0.074564983 -1.989351696  0.619825748
##  [26] -0.056128740 -0.155795507 -1.470752384 -0.478150055  0.417941560
##  [31]  1.358679552 -0.102787727  0.387671612 -0.053805041 -1.377059557
##  [36] -0.414994563 -0.394289954 -0.059313397  1.100025372  0.763175748
##  [41] -0.164523596 -0.253361680  0.696963375  0.556663199 -0.688755695
##  [46] -0.707495157  0.364581962  0.768532925 -0.112346212  0.881107726
##  [51]  0.398105880 -0.612026393  0.341119691 -1.129363096  1.433023702
##  [56]  1.980399899 -0.367221476 -1.044134626  0.569719627 -0.135054604
##  [61]  2.401617761 -0.039240003  0.689739362  0.028002159 -0.743273209
##  [66]  0.188792300 -1.804958629  1.465554862  0.153253338  2.172611670
##  [71]  0.475509529 -0.709946431  0.610726353 -0.934097632 -1.253633400
##  [76]  0.291446236 -0.443291873  0.001105352  0.074341324 -0.589520946
##  [81] -0.568668733 -0.135178615  1.178086997 -1.523566800  0.593946188
##  [86]  0.332950371  1.063099837 -0.304183924  0.370018810  0.267098791
##  [91] -0.542520031  1.207867806  1.160402616  0.700213650  1.586833455
##  [96]  0.558486426 -1.276592208 -0.573265414 -1.224612615 -0.473400636</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(x)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="h7-a-18033-2018-11-23" class="section level2">
<h2>H7 A-18033-2018-11-23</h2>
</div>
<div id="q1" class="section level2">
<h2>Q1</h2>
<p>For exercise 9.6, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until the chain has converged approximately to the target distribution according to <span class="math inline">\(\hat R &lt; 1.2\)</span>.</p>
</div>
<div id="a1" class="section level2">
<h2>A1</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#9.6</span>
<span class="co">#It is obvious that theta belongs to [0,1]</span>
<span class="co">#i chooose the beta(1+a,2-a) as the proposal distrubution</span>
<span class="co">#</span>
<span class="co">#(125,18,20,34)</span>
<span class="co">#</span>
CMD &lt;-<span class="st"> </span><span class="cf">function</span>(theta){
  <span class="co">#return the probabilities vector of the corresponding multinomial distribution </span>
  <span class="cf">if</span>(theta <span class="op">&gt;</span><span class="dv">1</span>) <span class="kw">return</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))
  <span class="cf">if</span>(theta <span class="op">&lt;</span><span class="dv">0</span>) <span class="kw">return</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))
  <span class="kw">return</span>(<span class="kw">c</span>(<span class="fl">0.5</span><span class="op">+</span>theta<span class="op">/</span><span class="dv">4</span>,(<span class="dv">1</span><span class="op">-</span>theta)<span class="op">/</span><span class="dv">4</span>,(<span class="dv">1</span><span class="op">-</span>theta)<span class="op">/</span><span class="dv">4</span>,theta<span class="op">/</span><span class="dv">4</span>))
}

LMCMD &lt;-<span class="st"> </span><span class="cf">function</span>(r,data){
  p &lt;-<span class="st"> </span><span class="kw">CMD</span>(r)
  <span class="kw">return</span>(p[<span class="dv">1</span>]<span class="op">^</span>data[<span class="dv">1</span>]<span class="op">*</span>p[<span class="dv">2</span>]<span class="op">^</span>data[<span class="dv">2</span>]<span class="op">*</span>p[<span class="dv">3</span>]<span class="op">^</span>data[<span class="dv">3</span>]<span class="op">*</span>p[<span class="dv">4</span>]<span class="op">^</span>data[<span class="dv">4</span>])
}

MCMC2 &lt;-<span class="st"> </span><span class="cf">function</span>(N,data,<span class="dt">startx=</span><span class="fl">0.5</span>){
  mchain &lt;-<span class="st"> </span><span class="kw">numeric</span>(N) 
  mchain[<span class="dv">1</span>] =<span class="st"> </span>startx
  k=<span class="dv">0</span>
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(N<span class="op">-</span><span class="dv">1</span>)){
    r &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">1</span>,<span class="dv">1</span><span class="op">+</span>mchain[i],<span class="dv">2</span><span class="op">-</span>mchain[i])
    a =<span class="st"> </span><span class="kw">LMCMD</span>(r,data) <span class="op">*</span><span class="st"> </span><span class="kw">dbeta</span>(mchain[i],<span class="dv">1</span><span class="op">+</span>r,<span class="dv">2</span><span class="op">-</span>r)<span class="op">/</span><span class="st"> </span><span class="kw">LMCMD</span>(mchain[i],data)<span class="op">/</span><span class="st">  </span><span class="kw">dbeta</span>(r,<span class="dv">1</span><span class="op">+</span>mchain[i],<span class="dv">2</span><span class="op">-</span>mchain[i])
    nr &lt;-<span class="kw">runif</span>(<span class="dv">1</span>)
    <span class="cf">if</span>(nr<span class="op">&lt;</span>a) mchain[i<span class="op">+</span><span class="dv">1</span>]=r <span class="cf">else</span> mchain[i<span class="op">+</span><span class="dv">1</span>]=mchain[i]
  }
  <span class="kw">return</span>(mchain)
}


<span class="co">#cov</span>

Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) { 
  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j]) </span>
  <span class="co"># for chain in i-th row of X </span>
  psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)
  n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi) 
  k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)
  psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi) <span class="co">#row means </span>
  B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means) <span class="co">#between variance est. </span>
  psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances </span>
  W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w) <span class="co">#within est. </span>
  v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n) <span class="co">#upper variance est. </span>
  r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W <span class="co">#G-R statistic </span>
  <span class="kw">return</span>(r.hat) 
}

<span class="kw">set.seed</span>(<span class="dv">123</span>)
k=<span class="dv">3</span>
N=<span class="dv">5000</span>
data &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">125</span>,<span class="dv">18</span>,<span class="dv">20</span>,<span class="dv">34</span>)
startx &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="fl">0.9</span>)
startn &lt;-<span class="dv">1000</span>
a &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,k,N)
<span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){
  mchain2 &lt;-<span class="st"> </span><span class="kw">MCMC2</span>(N,data,startx[j])
  a[j,] &lt;-<span class="st"> </span>mchain2
}

<span class="kw">Gelman.Rubin</span>(a)</code></pre></div>
<pre><code>## [1] 1.003609</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n=<span class="dv">5</span>
psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(a, <span class="dv">1</span>, cumsum)) 
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi)) psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi)) 
<span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psi))</code></pre></div>
<pre><code>## [1] 1.099351</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#plot psi for the three chains </span>
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)) 
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) <span class="kw">plot</span>(psi[i, (n<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span>i, <span class="dt">ylab=</span><span class="kw">bquote</span>(psi)) 
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#plot the sequence of R-hat statistics rhat &lt;- rep(0, n) for (j in (b+1):n) rhat[j] &lt;- Gelman.Rubin(psi[,1:j]) plot(rhat[(b+1):n], type=&quot;l&quot;, xlab=&quot;&quot;, ylab=&quot;R&quot;) abline(h=1.1, lty=2)</span>

b &lt;-<span class="st"> </span><span class="kw">numeric</span>(N<span class="op">-</span>n<span class="op">+</span><span class="dv">1</span>)
<span class="cf">for</span>(i <span class="cf">in</span> n<span class="op">:</span>N)
  b[i<span class="op">-</span>n<span class="op">+</span><span class="dv">1</span>]=<span class="kw">Gelman.Rubin</span>(a[,<span class="dv">1</span><span class="op">:</span>i])
<span class="kw">plot</span>(n<span class="op">:</span>N,b,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)
<span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>,<span class="dt">col=</span><span class="dv">3</span>)
<span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.1</span>,<span class="dt">col=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAADFBMVEUAAAAAzQD/AAD///8wMOiuAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACoUlEQVR4nO3bwW6CQBRAUVr//5+brirVcgcwtXbO3akPQw5vRTLLRZstz76Bvx6gCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGg6B7QMm2jQA9+CC8ToAhQBCgCFAGKAEWAot1As0kBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaBoG+jOqSBANmgVoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEXbQM6L2aAKUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgKJtIOfFbFAFKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQNE2kPNiNqgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFO0Gmk0IUAQoAhQBigBFgCJAEaAIUDQK9DZtu9FsEKDrAEUHgOYS2g802QoBigBFgCJA0SjQ+7TtR7NBgK4CFAGKDgDNJQQoAhQdAloNfH76x2T1auPmvNjXwLLu9pKXbgzoh+++/8kKZutxvGCHgGYKUAQoAhQBigBFgCJA0TDQtA0Cjf34q9PPuxVAgM5NAwJ0bhoQoHPTgACdmwb0UIMJAxQBigBFgCJAEaAIUAQo+gB7SLbg6lFTOwAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#top 50 5-50</span>
<span class="kw">plot</span>(n<span class="op">:</span>N<span class="op">/</span><span class="dv">100</span>,b,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)
<span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>,<span class="dt">col=</span><span class="dv">3</span>)
<span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.1</span>,<span class="dt">col=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAADFBMVEUAAAAAzQD/AAD///8wMOiuAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACoUlEQVR4nO3bwW6CQBRAUVr//5+brirVcgcwtXbO3akPQw5vRTLLRZstz76Bvx6gCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGg6B7QMm2jQA9+CC8ToAhQBCgCFAGKAEWAot1As0kBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaBoG+jOqSBANmgVoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEXbQM6L2aAKUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgKJtIOfFbFAFKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQNE2kPNiNqgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFO0Gmk0IUAQoAhQBigBFgCJAEaAIUDQK9DZtu9FsEKDrAEUHgOYS2g802QoBigBFgCJA0SjQ+7TtR7NBgK4CFAGKDgDNJQQoAhQdAloNfH76x2T1auPmvNjXwLLu9pKXbgzoh+++/8kKZutxvGCHgGYKUAQoAhQBigBFgCJA0TDQtA0Cjf34q9PPuxVAgM5NAwJ0bhoQoHPTgACdmwb0UIMJAxQBigBFgCJAEaAIUAQo+gB7SLbg6lFTOwAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># chain has approximately converged to the target distribution within approximately 5000 iterations </span>
<span class="co">#</span>
<span class="co"># chain has approximately converged to the target distribution within approximately 5000 iterations </span></code></pre></div>
</div>
<div id="q2" class="section level1">
<h1>Q2</h1>
<p>Find the intersection points A(k) in (0 ,<span class="math inline">\(\sqrt k\)</span>) of the curves</p>
<p>$ S_{k-1}(a)=P t(k-1) &gt;\sqrt { )$</p>
<p>and</p>
<p>$ S_{k}(a)=P t(k) &gt; $</p>
<p>354 Statistical Computing with R for k = 4 : 25 ,100,500,1000, where t(k) is a Student t random variable with k degrees of freedom. (These intersection points determine the critical values for a t-test for scale-mixture errors proposed by Sz???ekely [260].)</p>
</div>
<div id="a2" class="section level1">
<h1>A2</h1>
<p>for the upper sqrt(k) is unavailable and the lower 0 is also a ooot ,I first add a small deviation : 1e-5. After the first part , I change the upper for the right answer what I want</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Sk_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="cf">function</span>(a,k){
  q &lt;-<span class="st"> </span><span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)) 
  <span class="kw">return</span> (<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(q,<span class="dt">df=</span>k<span class="op">-</span><span class="dv">1</span>))
}
Sk &lt;-<span class="st"> </span><span class="cf">function</span>(a,k){
  q &lt;-<span class="st"> </span><span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)) 
  <span class="kw">return</span> (<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(q,<span class="dt">df=</span>k))
}
difSK &lt;-<span class="st"> </span><span class="cf">function</span>(x,k) { 
  <span class="kw">Sk_1</span>(x,k)<span class="op">-</span><span class="kw">Sk</span>(x,k)
}
kset &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)
out &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(kset)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(kset)){
  out[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>( difSK
                     , <span class="dt">lower =</span> <span class="dv">0</span><span class="op">+</span><span class="fl">1e-5</span>, <span class="dt">upper =</span> <span class="kw">sqrt</span>(kset[i])<span class="op">-</span><span class="fl">1e-5</span>,<span class="dt">k=</span>kset[i]) <span class="op">$</span>root
}
out</code></pre></div>
<pre><code>##  [1]  1.492103  1.533549  1.562768  1.584421  1.601182  1.614523  1.625387
##  [8]  1.634409  1.642025  1.648540  1.654177  1.659098  1.663451  1.667288
## [15]  1.670736  1.673841  1.676588  1.679139  1.681461  4.795822  4.898969
## [22]  4.999990  9.999990 22.360670 31.622767</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">###########
<span class="co">#not all right </span>
###########

kset[ <span class="kw">abs</span>(out<span class="op">-</span><span class="kw">sqrt</span>(kset)) <span class="op">&lt;</span><span class="st"> </span><span class="kw">sqrt</span>(kset)<span class="op">*</span><span class="fl">0.01</span>]</code></pre></div>
<pre><code>## [1]   23   24   25  100  500 1000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#It is shown that when k large than 22 ,the root is a wrong ,so we musst change the  </span>
n &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(kset)
Kwrongnum &lt;-<span class="st"> </span>n[<span class="kw">abs</span>(out<span class="op">-</span><span class="kw">sqrt</span>(kset)) <span class="op">&lt;</span><span class="st"> </span><span class="kw">sqrt</span>(kset)<span class="op">*</span><span class="fl">0.01</span>]

<span class="co">#based on the curve and the increasing of the answer,I change the upper </span>
<span class="co">#Example : k=23</span>
k=<span class="dv">23</span>
xx &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.01</span>,<span class="kw">sqrt</span>(k)<span class="op">-</span><span class="fl">1e-5</span>,<span class="dt">length=</span><span class="dv">1000</span>)
y &lt;-<span class="st"> </span><span class="kw">difSK</span>(xx,k)
<span class="kw">plot</span>(xx,y,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Example : k=1000</span>
k=<span class="dv">1000</span>
xx &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.01</span>,<span class="kw">sqrt</span>(k)<span class="op">-</span><span class="fl">1e-5</span>,<span class="dt">length=</span><span class="dv">1000</span>)
y &lt;-<span class="st"> </span><span class="kw">difSK</span>(xx,k)
<span class="kw">plot</span>(xx,y,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#change upper to 3</span>

<span class="cf">for</span> (i <span class="cf">in</span> Kwrongnum){
  out[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>( difSK
                     , <span class="dt">lower =</span> <span class="dv">0</span><span class="op">+</span><span class="fl">1e-5</span>, <span class="dt">upper =</span><span class="dv">3</span>,<span class="dt">k=</span>kset[i]) <span class="op">$</span>root
}
<span class="kw">names</span>(out) &lt;-<span class="st"> </span>kset

out</code></pre></div>
<pre><code>##        4        5        6        7        8        9       10       11 
## 1.492103 1.533549 1.562768 1.584421 1.601182 1.614523 1.625387 1.634409 
##       12       13       14       15       16       17       18       19 
## 1.642025 1.648540 1.654177 1.659098 1.663451 1.667288 1.670736 1.673841 
##       20       21       22       23       24       25      100      500 
## 1.676588 1.679139 1.681461 1.683594 1.685546 1.687347 1.720601 1.729747 
##     1000 
## 1.730911</code></pre>
<div id="example-2-data" class="section level2">
<h2>Example 2 : data</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris</code></pre></div>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
## 1            5.1         3.5          1.4         0.2     setosa
## 2            4.9         3.0          1.4         0.2     setosa
## 3            4.7         3.2          1.3         0.2     setosa
## 4            4.6         3.1          1.5         0.2     setosa
## 5            5.0         3.6          1.4         0.2     setosa
## 6            5.4         3.9          1.7         0.4     setosa
## 7            4.6         3.4          1.4         0.3     setosa
## 8            5.0         3.4          1.5         0.2     setosa
## 9            4.4         2.9          1.4         0.2     setosa
## 10           4.9         3.1          1.5         0.1     setosa
## 11           5.4         3.7          1.5         0.2     setosa
## 12           4.8         3.4          1.6         0.2     setosa
## 13           4.8         3.0          1.4         0.1     setosa
## 14           4.3         3.0          1.1         0.1     setosa
## 15           5.8         4.0          1.2         0.2     setosa
## 16           5.7         4.4          1.5         0.4     setosa
## 17           5.4         3.9          1.3         0.4     setosa
## 18           5.1         3.5          1.4         0.3     setosa
## 19           5.7         3.8          1.7         0.3     setosa
## 20           5.1         3.8          1.5         0.3     setosa
## 21           5.4         3.4          1.7         0.2     setosa
## 22           5.1         3.7          1.5         0.4     setosa
## 23           4.6         3.6          1.0         0.2     setosa
## 24           5.1         3.3          1.7         0.5     setosa
## 25           4.8         3.4          1.9         0.2     setosa
## 26           5.0         3.0          1.6         0.2     setosa
## 27           5.0         3.4          1.6         0.4     setosa
## 28           5.2         3.5          1.5         0.2     setosa
## 29           5.2         3.4          1.4         0.2     setosa
## 30           4.7         3.2          1.6         0.2     setosa
## 31           4.8         3.1          1.6         0.2     setosa
## 32           5.4         3.4          1.5         0.4     setosa
## 33           5.2         4.1          1.5         0.1     setosa
## 34           5.5         4.2          1.4         0.2     setosa
## 35           4.9         3.1          1.5         0.2     setosa
## 36           5.0         3.2          1.2         0.2     setosa
## 37           5.5         3.5          1.3         0.2     setosa
## 38           4.9         3.6          1.4         0.1     setosa
## 39           4.4         3.0          1.3         0.2     setosa
## 40           5.1         3.4          1.5         0.2     setosa
## 41           5.0         3.5          1.3         0.3     setosa
## 42           4.5         2.3          1.3         0.3     setosa
## 43           4.4         3.2          1.3         0.2     setosa
## 44           5.0         3.5          1.6         0.6     setosa
## 45           5.1         3.8          1.9         0.4     setosa
## 46           4.8         3.0          1.4         0.3     setosa
## 47           5.1         3.8          1.6         0.2     setosa
## 48           4.6         3.2          1.4         0.2     setosa
## 49           5.3         3.7          1.5         0.2     setosa
## 50           5.0         3.3          1.4         0.2     setosa
## 51           7.0         3.2          4.7         1.4 versicolor
## 52           6.4         3.2          4.5         1.5 versicolor
## 53           6.9         3.1          4.9         1.5 versicolor
## 54           5.5         2.3          4.0         1.3 versicolor
## 55           6.5         2.8          4.6         1.5 versicolor
## 56           5.7         2.8          4.5         1.3 versicolor
## 57           6.3         3.3          4.7         1.6 versicolor
## 58           4.9         2.4          3.3         1.0 versicolor
## 59           6.6         2.9          4.6         1.3 versicolor
## 60           5.2         2.7          3.9         1.4 versicolor
## 61           5.0         2.0          3.5         1.0 versicolor
## 62           5.9         3.0          4.2         1.5 versicolor
## 63           6.0         2.2          4.0         1.0 versicolor
## 64           6.1         2.9          4.7         1.4 versicolor
## 65           5.6         2.9          3.6         1.3 versicolor
## 66           6.7         3.1          4.4         1.4 versicolor
## 67           5.6         3.0          4.5         1.5 versicolor
## 68           5.8         2.7          4.1         1.0 versicolor
## 69           6.2         2.2          4.5         1.5 versicolor
## 70           5.6         2.5          3.9         1.1 versicolor
## 71           5.9         3.2          4.8         1.8 versicolor
## 72           6.1         2.8          4.0         1.3 versicolor
## 73           6.3         2.5          4.9         1.5 versicolor
## 74           6.1         2.8          4.7         1.2 versicolor
## 75           6.4         2.9          4.3         1.3 versicolor
## 76           6.6         3.0          4.4         1.4 versicolor
## 77           6.8         2.8          4.8         1.4 versicolor
## 78           6.7         3.0          5.0         1.7 versicolor
## 79           6.0         2.9          4.5         1.5 versicolor
## 80           5.7         2.6          3.5         1.0 versicolor
## 81           5.5         2.4          3.8         1.1 versicolor
## 82           5.5         2.4          3.7         1.0 versicolor
## 83           5.8         2.7          3.9         1.2 versicolor
## 84           6.0         2.7          5.1         1.6 versicolor
## 85           5.4         3.0          4.5         1.5 versicolor
## 86           6.0         3.4          4.5         1.6 versicolor
## 87           6.7         3.1          4.7         1.5 versicolor
## 88           6.3         2.3          4.4         1.3 versicolor
## 89           5.6         3.0          4.1         1.3 versicolor
## 90           5.5         2.5          4.0         1.3 versicolor
## 91           5.5         2.6          4.4         1.2 versicolor
## 92           6.1         3.0          4.6         1.4 versicolor
## 93           5.8         2.6          4.0         1.2 versicolor
## 94           5.0         2.3          3.3         1.0 versicolor
## 95           5.6         2.7          4.2         1.3 versicolor
## 96           5.7         3.0          4.2         1.2 versicolor
## 97           5.7         2.9          4.2         1.3 versicolor
## 98           6.2         2.9          4.3         1.3 versicolor
## 99           5.1         2.5          3.0         1.1 versicolor
## 100          5.7         2.8          4.1         1.3 versicolor
## 101          6.3         3.3          6.0         2.5  virginica
## 102          5.8         2.7          5.1         1.9  virginica
## 103          7.1         3.0          5.9         2.1  virginica
## 104          6.3         2.9          5.6         1.8  virginica
## 105          6.5         3.0          5.8         2.2  virginica
## 106          7.6         3.0          6.6         2.1  virginica
## 107          4.9         2.5          4.5         1.7  virginica
## 108          7.3         2.9          6.3         1.8  virginica
## 109          6.7         2.5          5.8         1.8  virginica
## 110          7.2         3.6          6.1         2.5  virginica
## 111          6.5         3.2          5.1         2.0  virginica
## 112          6.4         2.7          5.3         1.9  virginica
## 113          6.8         3.0          5.5         2.1  virginica
## 114          5.7         2.5          5.0         2.0  virginica
## 115          5.8         2.8          5.1         2.4  virginica
## 116          6.4         3.2          5.3         2.3  virginica
## 117          6.5         3.0          5.5         1.8  virginica
## 118          7.7         3.8          6.7         2.2  virginica
## 119          7.7         2.6          6.9         2.3  virginica
## 120          6.0         2.2          5.0         1.5  virginica
## 121          6.9         3.2          5.7         2.3  virginica
## 122          5.6         2.8          4.9         2.0  virginica
## 123          7.7         2.8          6.7         2.0  virginica
## 124          6.3         2.7          4.9         1.8  virginica
## 125          6.7         3.3          5.7         2.1  virginica
## 126          7.2         3.2          6.0         1.8  virginica
## 127          6.2         2.8          4.8         1.8  virginica
## 128          6.1         3.0          4.9         1.8  virginica
## 129          6.4         2.8          5.6         2.1  virginica
## 130          7.2         3.0          5.8         1.6  virginica
## 131          7.4         2.8          6.1         1.9  virginica
## 132          7.9         3.8          6.4         2.0  virginica
## 133          6.4         2.8          5.6         2.2  virginica
## 134          6.3         2.8          5.1         1.5  virginica
## 135          6.1         2.6          5.6         1.4  virginica
## 136          7.7         3.0          6.1         2.3  virginica
## 137          6.3         3.4          5.6         2.4  virginica
## 138          6.4         3.1          5.5         1.8  virginica
## 139          6.0         3.0          4.8         1.8  virginica
## 140          6.9         3.1          5.4         2.1  virginica
## 141          6.7         3.1          5.6         2.4  virginica
## 142          6.9         3.1          5.1         2.3  virginica
## 143          5.8         2.7          5.1         1.9  virginica
## 144          6.8         3.2          5.9         2.3  virginica
## 145          6.7         3.3          5.7         2.5  virginica
## 146          6.7         3.0          5.2         2.3  virginica
## 147          6.3         2.5          5.0         1.9  virginica
## 148          6.5         3.0          5.2         2.0  virginica
## 149          6.2         3.4          5.4         2.3  virginica
## 150          5.9         3.0          5.1         1.8  virginica</code></pre>
</div>
<div id="example-3-plot" class="section level2">
<h2>Example 3 : Plot</h2>
<p>QQ-plot and residual error of liner model of iris <img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="h2-a-18033-2018-09-21" class="section level2">
<h2>H2 A-18033-2018-09-21</h2>
</div>
<div id="q1-1" class="section level2">
<h2>Q1</h2>
<p>3.5 A discrete random variable X has probability mass function</p>
<table>
<thead>
<tr class="header">
<th>X</th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>p</td>
<td>0.1</td>
<td>0.2</td>
<td>0.2</td>
<td>0.2</td>
<td>0.3</td>
</tr>
</tbody>
</table>
<p>Use the inverse transform method to generate a random sample of size 1000 from the distribution of X. Construct a relative frequency table and compare the empirical with the theoretical probabilities. Repeat using the R sample function.</p>
</div>
<div id="a1-1" class="section level2">
<h2>A1</h2>
<table>
<caption>Table 1???a relative frequency table using the inverse transform method to generate</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">0</th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>empirical</td>
<td align="right">0.099</td>
<td align="right">0.197</td>
<td align="right">0.211</td>
<td align="right">0.198</td>
<td align="right">0.295</td>
</tr>
<tr class="even">
<td>theoretical</td>
<td align="right">0.100</td>
<td align="right">0.200</td>
<td align="right">0.200</td>
<td align="right">0.200</td>
<td align="right">0.300</td>
</tr>
</tbody>
</table>
<table>
<caption>Table 2???a relative frequency table using Sample</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">0</th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>empirical</td>
<td align="right">0.085</td>
<td align="right">0.212</td>
<td align="right">0.205</td>
<td align="right">0.2</td>
<td align="right">0.298</td>
</tr>
<tr class="even">
<td>theoretical</td>
<td align="right">0.100</td>
<td align="right">0.200</td>
<td align="right">0.200</td>
<td align="right">0.2</td>
<td align="right">0.300</td>
</tr>
</tbody>
</table>
<p>Rcode and the note ???</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">X &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">4</span>)
p &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>)
csp &lt;-<span class="st">  </span><span class="kw">cumsum</span>(p)
<span class="co">#the inverse transform method</span>
ITMSample &lt;-<span class="st"> </span><span class="cf">function</span>(x,csp,N){
  <span class="co">#x???sample csp???Cumulative Distribution Function  N???Number of Sample</span>
  csp&lt;-<span class="kw">c</span>(csp,<span class="dv">1</span>)
  y&lt;-<span class="dv">1</span><span class="op">:</span>N
  <span class="co">#note theresult</span>
  r&lt;-<span class="kw">runif</span>(N)
  <span class="co">#gemerate random numbers</span>
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){
    k =<span class="st"> </span>r[i]
    j=<span class="dv">1</span> 
    <span class="cf">while</span>(csp[j]<span class="op">&lt;</span>k) j=j<span class="op">+</span><span class="dv">1</span>
    y[i]=x[j]
  }
  <span class="kw">return</span>(y) 
}
<span class="kw">set.seed</span>(<span class="dv">123</span>)
N&lt;-<span class="dv">1000</span>
rus1&lt;-<span class="kw">ITMSample</span>(X,csp,N)
tableRE1 &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">table</span>(rus1),p)
tableRE1[<span class="dv">1</span>,]&lt;-tableRE1[<span class="dv">1</span>,]<span class="op">/</span>N
<span class="kw">rownames</span>(tableRE1)&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'empirical'</span>,<span class="st">'theoretical'</span>)
<span class="co">#knitr::kable(tableRE1, caption=&quot;Table 1???a relative frequency table using the inverse transform method to generate &quot;)</span>
<span class="co">#make the table</span>

<span class="co">#sample</span>
rus2&lt;-<span class="kw">sample</span>(X,N,<span class="dt">replace =</span> <span class="ot">TRUE</span>,<span class="dt">prob=</span>p)
tableRE2 &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">table</span>(rus2),p)
tableRE2[<span class="dv">1</span>,]&lt;-tableRE2[<span class="dv">1</span>,]<span class="op">/</span>N
<span class="kw">rownames</span>(tableRE2)&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'empirical'</span>,<span class="st">'theoretical'</span>)
<span class="co">#knitr::kable(tableRE2, caption=&quot;Table 2???a relative frequency table using Sample &quot;)</span>
<span class="co">#make the table</span></code></pre></div>
</div>
<div id="q2-1" class="section level2">
<h2>Q2</h2>
<p>3.7 Write a function to generate a random sample of size n from the Beta(a,b) distribution by the acceptance-rejection method. Generate a random sample of size 1000 from the Beta(3,2) distribution. Graph the histogram of the sample with the theoretical Beta(3,2) density superimposed.</p>
</div>
<div id="a2-1" class="section level2">
<h2>A2</h2>
<p>For the range of beta distribution is (0,1) and the maximum of density function of beta(3,2) below than 1.8, I choose the uniform distribution and c =1.8</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Rcode and the note ???</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#find the maximum of density function </span>
x&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.0001</span>)
N&lt;-<span class="kw">length</span>(x)
y&lt;-<span class="dv">1</span><span class="op">:</span>N
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){
  y[i]&lt;-<span class="kw">dbeta</span>(x[i],<span class="dv">3</span>,<span class="dv">2</span>)
}
<span class="co">#max(y)</span>
<span class="co">#function acceptance-rejection method</span>
ARMsample_beta &lt;-<span class="st"> </span><span class="cf">function</span>(beta1,beta2,maxd,N){
  <span class="co">#beta1,beta2 the non-negative parameters of the Beta distribution.</span>
  <span class="co">#maxd the c of acceptance-rejection method</span>
  <span class="co">#N number before rejection</span>
  r1&lt;-<span class="kw">runif</span>(N)
  <span class="co">#??????????????????</span>
  y &lt;-<span class="st"> </span><span class="ot">NULL</span>
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){
    <span class="cf">if</span>(<span class="kw">dbeta</span>(r1[i],beta1,beta2)<span class="op">&gt;</span><span class="st"> </span>maxd<span class="op">*</span><span class="kw">runif</span>(<span class="dv">1</span>) ) y&lt;-<span class="kw">c</span>(y,r1[i])
    <span class="co">#????????????</span>
  }
  <span class="kw">return</span>(y)
}
<span class="kw">set.seed</span>(<span class="dv">1234</span>)
rus&lt;-<span class="kw">ARMsample_beta</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="fl">1.8</span>,<span class="dv">2000</span>)
<span class="co">#length(rus)</span>
<span class="co">#???????????????37%</span>
rus1&lt;-rus[<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>]
<span class="co">#hist(rus1,main=&quot; histogram of the sample and the theoretical density superimposed&quot;,freq=FALSE)</span>
<span class="co">#lines(x,y)</span></code></pre></div>
</div>
<div id="q3" class="section level2">
<h2>Q3</h2>
<p>3.12 Simulate a continuous E xponential-Gamma mixture. Suppose that the rate parameter ?? has Gamma(r,??) distribution and Y has Exp(??) distribution. That is, <span class="math inline">\((Y|??=??) ??? f_Y(y|??)=??e^{-??y}\)</span> . Generate 1000 random observations from this mixture with r = 4 and ?? = 2.</p>
</div>
<div id="a3" class="section level2">
<h2>A3</h2>
<p>first I use the rgamma to aenerate the random number from Gamma(r,??),then use the rexpto aenerate the random number</p>
<p>the function called rExp_Gamma</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rExp_Gamma &lt;-<span class="st"> </span><span class="cf">function</span>(r,beta,N){
  <span class="co">#N number</span>
  y&lt;-<span class="dv">1</span><span class="op">:</span>N
  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){
    x&lt;-<span class="st"> </span><span class="kw">rgamma</span>(<span class="dv">1</span>,r,beta)
    y[i]&lt;-<span class="kw">rexp</span>(<span class="dv">1</span>,x)
  }
  <span class="kw">return</span>(y)
}
<span class="kw">set.seed</span>(<span class="dv">12</span>)
rus&lt;-<span class="kw">rExp_Gamma</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1000</span>)
<span class="kw">hist</span>(rus,<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="kw">max</span>(rus)<span class="op">+</span><span class="fl">0.5</span>,<span class="fl">0.5</span>),<span class="dt">main=</span><span class="st">&quot;histogram of the random number&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="h3-r-18033-2018-09-28" class="section level2">
<h2>H3 R-18033-2018-09-28</h2>
</div>
<div id="q1-2" class="section level2">
<h2>Q1</h2>
<p>5.4 Write a function to compute a Monte Carlo estimate of the Beta(3, 3) cdf, and use the function to estimate F(x) forx =0 .1,0.2,…,0.9. Compare the estimates with the values returned by the pbeta function in R.</p>
</div>
<div id="a1-2" class="section level2">
<h2>A1</h2>
<p>I use betacdfMC function to generate random numbers and estimate the cdf There are estimated values by generating 10000,100000,1000000 random numbers and theoretical value from pbeta function</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">betacdfMC &lt;-<span class="st"> </span><span class="cf">function</span>(x,beta1,beta2,<span class="dt">N=</span><span class="dv">10000</span>) {
  <span class="co">#x F(x),x can be a number or a vector</span>
  ##beta1,beta2 the non-negative parameters of the Beta distribution.
  <span class="co">#N numbers of random number</span>
  y&lt;-<span class="kw">rbeta</span>(N,<span class="dv">3</span>,<span class="dv">3</span>)
  X&lt;-<span class="kw">matrix</span>(x,<span class="kw">length</span>(x),N)
  Y&lt;-<span class="kw">matrix</span>(y,<span class="kw">length</span>(x),N,<span class="dt">byrow=</span>T)
  <span class="co">#</span>
  <span class="kw">return</span>(<span class="kw">rowSums</span>(Y<span class="op">&lt;=</span>X)<span class="op">/</span>N)
}
<span class="kw">set.seed</span>(<span class="dv">123</span>)
A1_<span class="dv">1</span>&lt;-<span class="kw">betacdfMC</span>(<span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>),<span class="dv">3</span>,<span class="dv">3</span>)
<span class="co">#A1_1</span>
<span class="co">#100000</span>
A1_<span class="dv">2</span>&lt;-<span class="kw">betacdfMC</span>(<span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>),<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">100000</span>)
<span class="co">#A1_2</span>
<span class="co">#1000000</span>
A1_<span class="dv">3</span>&lt;-<span class="kw">betacdfMC</span>(<span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>),<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1000000</span>)
<span class="co">#A1_3</span>
<span class="co">#theoretical value</span>
A1_t&lt;-<span class="kw">pbeta</span>(<span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>),<span class="dv">3</span>,<span class="dv">3</span>)
<span class="co">#A1_t</span>

A1 &lt;-<span class="st"> </span><span class="kw">rbind</span>(A1_<span class="dv">1</span>,A1_<span class="dv">2</span>,A1_<span class="dv">3</span>,A1_t)
<span class="kw">colnames</span>(A1)&lt;-<span class="kw">c</span>(<span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>))
<span class="kw">rownames</span>(A1)&lt;-<span class="kw">c</span>(<span class="fl">1e+04</span>,<span class="fl">1e+05</span>,<span class="fl">1e+06</span>,<span class="st">'theoretical'</span>)
A1</code></pre></div>
<pre><code>##                  0.1      0.2      0.3      0.4      0.5     0.6      0.7
## 10000       0.009700 0.061000 0.164400 0.315600 0.504300 0.68220 0.835200
## 1e+05       0.008520 0.057940 0.162470 0.317020 0.498770 0.68076 0.836960
## 1e+06       0.008595 0.057645 0.163426 0.318259 0.500518 0.68307 0.837106
## theoretical 0.008560 0.057920 0.163080 0.317440 0.500000 0.68256 0.836920
##                  0.8      0.9
## 10000       0.944600 0.992000
## 1e+05       0.941460 0.991660
## 1e+06       0.942014 0.991463
## theoretical 0.942080 0.991440</code></pre>
</div>
<div id="q2-2" class="section level2">
<h2>Q2</h2>
<p>5.9 The Rayleigh density [156, (18.76)] is <span class="math inline">\(f(x)= \frac{x}{??^2}e^{-\frac{x^2}{2??^2}}\)</span>,x ???0,??&gt;0. Implement a function to generate samples from a Rayleigh(??) distribution, using antithetic variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X+X'}{2}\)</span> compared with <span class="math inline">\(\frac{X1+X2}{2}\)</span> for independent X1, X2?</p>
<p>##A2 I find the inverse cdf to connect the antithetic variables U from uniform(0,1) to X</p>
<p>cdf: <span class="math inline">\(F(x)=1-e^{-\frac{x^2}{2??^2}}\)</span> inverse cdf:<span class="math inline">\(F^{-1}(u)=\sqrt{-2??^2ln(1-u)}\)</span></p>
<p>I generate 10000 random numbers 1000 times by function simpleicRa</p>
<p>the variance of <span class="math inline">\(\frac{X+X'}{2}\)</span> is 1.258606e-06</p>
<p>the variance of <span class="math inline">\(\frac{X1+X2}{2}\)</span> is 1.892159e-05</p>
<p>the variance of using antithetic variables is 0.0665169 of independent’s</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">invcdfRay &lt;-<span class="st"> </span><span class="cf">function</span>(u,e) <span class="kw">return</span>(<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>e<span class="op">*</span>e<span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u)))
<span class="co">#e :??</span>
simpleicRa &lt;-<span class="st"> </span><span class="cf">function</span>(Sigma,<span class="dt">N=</span><span class="dv">1000</span>){
<span class="co">#sigma: the parameter of Rayleigh(??) distribution</span>
<span class="co">#N numbers of random </span>
<span class="co">#The function creates N random numbers And N antithetic random number</span>
<span class="co">#the first N number is indenpendent ,the last N is antithetic of the top N</span>
u&lt;-<span class="kw">runif</span>(N)
y&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span><span class="op">*</span>N)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){
y[i]&lt;-<span class="kw">invcdfRay</span>(u[i],Sigma)
y[i<span class="op">+</span>N]&lt;-<span class="kw">invcdfRay</span>(<span class="dv">1</span><span class="op">-</span>u[i],Sigma)
}
<span class="kw">return</span>(y)
}
<span class="co">#I create 1000(N) random numbers 1000(n) times</span>
<span class="kw">set.seed</span>(<span class="dv">123</span>)
n=<span class="dv">100</span>
N=<span class="dv">10000</span>
sigma=<span class="dv">1</span>
x=xnew&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,n,<span class="dv">2</span><span class="op">*</span>N)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
x[i,]&lt;-<span class="kw">simpleicRa</span>(sigma,N)
}
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
xnew[i,]&lt;-<span class="kw">simpleicRa</span>(sigma,N)
}
n=n<span class="op">-</span>n<span class="op">%%</span><span class="dv">2</span>
<span class="co">#xin and x1: (X1+X2)/2 and y1 : n estimated value  </span>
xin&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,n,N)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
xin[i,] &lt;-<span class="st"> </span>(x[i,<span class="dv">1</span><span class="op">:</span>N]<span class="op">+</span>xnew[i,<span class="dv">1</span><span class="op">:</span>N])<span class="op">/</span><span class="dv">2</span>
}
y1&lt;-<span class="kw">rowMeans</span>(xin)

<span class="co">#x2 and xan X+X' and y2 : n estimated value </span>
xanti&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,n,N)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
  xanti[i,] &lt;-<span class="st"> </span>(x[i,<span class="dv">1</span><span class="op">:</span>N]<span class="op">+</span>x[i,N<span class="op">+</span><span class="dv">1</span><span class="op">:</span>N])<span class="op">/</span><span class="dv">2</span>
}
y2&lt;-<span class="kw">rowMeans</span>(xanti)
<span class="kw">var</span>(y1)</code></pre></div>
<pre><code>## [1] 1.892159e-05</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var</span>(y2)</code></pre></div>
<pre><code>## [1] 1.258606e-06</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var</span>(y2)<span class="op">/</span><span class="kw">var</span>(y1)</code></pre></div>
<pre><code>## [1] 0.0665169</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#var(y2) &lt; var (y1)</span></code></pre></div>
</div>
<div id="q3-1" class="section level2">
<h2>Q3</h2>
<p>5.13 Find two importance functions f1 and f2 that are supported on (1,???) and are ???close??? to <span class="math inline">\(g(x)= \frac{x^2} {\sqrt{2??}} e^{-\frac{x^2}{2}}\)</span> , x &gt; 1. Which of your two importance functions should produce the smaller variance in estimating <span class="math inline">\(\int_{1}^{\infty} \frac{x^2}{\sqrt{2??}}e^{-\frac{x^2}{2}} dx\)</span> by importance sampling? Explain.</p>
</div>
<div id="a3-1" class="section level2">
<h2>A3</h2>
<p>I choose two function:</p>
<p>f1 : <span class="math inline">\(f_{1}(x)= \frac{x} {\sqrt{e} }e^{-\frac{x^2}{2}} I(X\ge1)\)</span></p>
<p>f2 : <span class="math inline">\(f_{2}(x)= \frac{1}{2}e^{-\frac{x-1}{2}} I(X\ge1)\)</span></p>
<p>both functions are normalizated</p>
<p>f1 should produce the smaller variance in estimating <span class="math inline">\(\int_{1}^{\infty} \frac{x^2}{\sqrt{2??}}e^{-\frac{x^2}{2}} dx\)</span> by importance sampling,becasuse that ( in the main part of g(x) ) (maybe x&lt;=4 or x&lt;=6),f1 is more closer to g(x) than f2 by comparing <span class="math inline">\(\frac{f_2(x)}{g(x)}\)</span> and<span class="math inline">\(\frac{f_1(x)}{g(x)}\)</span></p>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>R code :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">funcg &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="cf">if</span>(x<span class="op">&gt;=</span><span class="dv">1</span>) x<span class="op">*</span>x<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">*</span>x<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi) <span class="cf">else</span> <span class="dv">0</span>
funcg_vec &lt;-<span class="cf">function</span>(X) {
  n&lt;-<span class="kw">length</span>(X)
  y&lt;-<span class="dv">1</span><span class="op">:</span>n
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)
    y[i]&lt;-<span class="kw">funcg</span>(X[i])
  <span class="kw">return</span>(y)
}

funcf1 &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="cf">if</span>(x<span class="op">&gt;=</span><span class="dv">1</span>) x<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">*</span>x<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="cf">else</span> <span class="dv">0</span>
funcf1_vec &lt;-<span class="cf">function</span>(X) {
  n&lt;-<span class="kw">length</span>(X)
  y&lt;-<span class="dv">1</span><span class="op">:</span>n
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)
    y[i]&lt;-<span class="kw">funcf1</span>(X[i])
  <span class="kw">return</span>(y)
}
funcf2 &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="cf">if</span>(x<span class="op">&gt;=</span><span class="dv">1</span>) <span class="kw">exp</span>(<span class="op">-</span>x<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="cf">else</span> <span class="dv">0</span>
funcf2_vec &lt;-<span class="cf">function</span>(X) {
  n&lt;-<span class="kw">length</span>(X)
  y&lt;-<span class="dv">1</span><span class="op">:</span>n
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)
    y[i]&lt;-<span class="kw">funcf2</span>(X[i])
  <span class="kw">return</span>(y)
}
<span class="co">#x&lt;-seq(1,10,0.001)</span>
<span class="co">#y&lt;-funcg_vec(x)</span>
<span class="co">#plot(x,y,ylim=c(0,1),type='l')</span>
<span class="co">#y2&lt;-funcf2_vec(x)</span>
<span class="co">#lines(x,y2,lty=2)</span>
<span class="co">#text(2,0.9,'f2',cex=2)</span>
<span class="co">#y1&lt;-funcf1_vec(x)</span>
<span class="co">#lines(x,y1,lty=10)</span>
<span class="co">#text(6,0.1,'f1',cex=2)</span>
<span class="co">#text(1.5,0.2,'g(x)',cex=2)</span>
<span class="co">#plot(x,y1/y,type='l',ylim=c(0,10))</span>
<span class="co">#lines(x,y2/y,lty=10)</span>
<span class="co">#text(6,2,'f1/g',cex=2)</span>
<span class="co">#text(4,8,'f2/g',cex=2)</span></code></pre></div>
</div>
<div id="q4" class="section level2">
<h2>Q4</h2>
<p>5.14 Obtain a Monte Carlo estimate of</p>
<p><span class="math inline">\(\int_{1}^{\infty} \frac{x^2}{\sqrt{2??}}e^{-\frac{x^2}{2}} dx\)</span></p>
<p>by importance sampling.</p>
</div>
<div id="a4" class="section level2">
<h2>A4</h2>
<p>I use the code from Q3 and generate 10000 random numbers by using inverse cdf.</p>
<p>cdf f1: <span class="math inline">\(F_{1}(x)=1-e^{\frac{1-x^2}{2}}\)</span></p>
<p>inverse cdf f1 : <span class="math inline">\(F^{-1}_{1}(u)=\sqrt{1-2ln(1-u)}\)</span></p>
<p>estimated value from f1 :0.3990829</p>
<p>estimated value from f1 using antithetic variables:0.4002061</p>
<p>cdf f2???<span class="math inline">\(F_{2}(x)=1-e^{\frac{1-x}{2}}\)</span></p>
<p>inverse cdf f2:<span class="math inline">\(F^{-1}_{2}(u)=1-2ln(1-u)\)</span></p>
<p>estimated value from f2: 0.4044936</p>
<p>estimated value from f1 using antithetic variables :0.4009006</p>
<p>Rcode :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">123</span>)
N=<span class="dv">10000</span>
u1&lt;-<span class="kw">runif</span>(N)
cdff1 &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)
Invcdff1 &lt;-<span class="st"> </span><span class="cf">function</span>(u) <span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))
Invcdff1_vec &lt;-<span class="st"> </span><span class="cf">function</span>(X) {
  n&lt;-<span class="kw">length</span>(X)
  y&lt;-<span class="dv">1</span><span class="op">:</span>n
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)
    y[i]&lt;-<span class="kw">Invcdff1</span>(X[i])
  <span class="kw">return</span>(y)
}
x1 &lt;-<span class="st"> </span><span class="kw">Invcdff1_vec</span>(u1)
y1&lt;-<span class="kw">sum</span>(<span class="kw">funcg_vec</span>(x1)<span class="op">/</span><span class="kw">funcf1_vec</span>(x1))<span class="op">/</span>N
y1</code></pre></div>
<pre><code>## [1] 0.3990829</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x1_an &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">Invcdff1_vec</span>(u1),<span class="kw">Invcdff1_vec</span>(<span class="dv">1</span><span class="op">-</span>u1))
y1_an &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">funcg_vec</span>(x1_an)<span class="op">/</span><span class="kw">funcf1_vec</span>(x1_an))<span class="op">/</span>N<span class="op">/</span><span class="dv">2</span>
y1_an</code></pre></div>
<pre><code>## [1] 0.4002061</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">u2&lt;-<span class="kw">runif</span>(N)
cdff2 &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)
Invcdff2 &lt;-<span class="st"> </span><span class="cf">function</span>(u) (<span class="dv">1</span><span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))
Invcdff2_vec &lt;-<span class="st"> </span><span class="cf">function</span>(X) {
  n&lt;-<span class="kw">length</span>(X)
  y&lt;-<span class="dv">1</span><span class="op">:</span>n
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)
    y[i]&lt;-<span class="kw">Invcdff2</span>(X[i])
  <span class="kw">return</span>(y)
}
x2 &lt;-<span class="st"> </span><span class="kw">Invcdff2_vec</span>(u2)
y2&lt;-<span class="kw">sum</span>(<span class="kw">funcg_vec</span>(x2)<span class="op">/</span><span class="kw">funcf2_vec</span>(x2))<span class="op">/</span>N
y2</code></pre></div>
<pre><code>## [1] 0.4044936</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x2_an &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">Invcdff2_vec</span>(u2),<span class="kw">Invcdff2_vec</span>(<span class="dv">1</span><span class="op">-</span>u2))
y2_an &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">funcg_vec</span>(x2_an)<span class="op">/</span><span class="kw">funcf2_vec</span>(x2_an))<span class="op">/</span>N<span class="op">/</span><span class="dv">2</span>
y2_an</code></pre></div>
<pre><code>## [1] 0.4009006</code></pre>
</div>
<div id="h4-a-18033-2018-10-12" class="section level2">
<h2>H4 A-18033-2018-10-12</h2>
</div>
<div id="q1-3" class="section level2">
<h2>Q1</h2>
<p>6.9 Let <span class="math inline">\(X\)</span> be a non-negative random variable with <span class="math inline">\(\mu=E[X]&lt;\infty\)</span>. For a random sample <span class="math inline">\(x_1,...,x_n\)</span> from the distribution of <span class="math inline">\(X\)</span>, the Gini ratio is de???ned by</p>
<p><span class="math inline">\(G=\frac{1}{2n^2\mu}\sum_{i=1}^{n}\sum_{j=1}^{n}|x_i-x_j|\)</span></p>
<p>The Gini ratio is applied in economics to measure inequality in income distribution (see e.g. [163]). Note that G can be written in terms of the order statistics <span class="math inline">\(x_{(i)}\)</span> as</p>
<p><span class="math inline">\(G=\frac{1}{n^2\mu}\sum_{i=1}^{n}(2i-n-1)x_{(i)}\)</span></p>
<p>If the mean is unknown,let <span class="math inline">\(\hat{G}\)</span> be the statistic <span class="math inline">\(G\)</span> with ?? replacedby <span class="math inline">\(\bar{x}\)</span>. Estimate by simulation the mean, median and deciles of <span class="math inline">\(\hat{G}\)</span> if <span class="math inline">\(X\)</span> is standard lognormal. Repeat the procedure for the uniform distribution and Bernoulli(0.1). Also construct density histograms of the replicates in each case.</p>
</div>
<div id="a1-3" class="section level2">
<h2>A1</h2>
<p>function GiniratioV is used for calculating the G</p>
<p>I generate 10000 random numbers 1000 times to calculate <span class="math inline">\(\hat{G}\)</span> 1000 times</p>
<div id="x-is-standard-lognormal" class="section level3">
<h3><span class="math inline">\(X\)</span> is standard lognormal:</h3>
<p>the mean:</p>
<p><code>## [1] 0.5205809</code> the median</p>
<pre><code>## [1] 0.5207894</code></pre>
<p>the deciles</p>
<pre><code>##       10%       20%       30%       40%       50%       60%       70% 
## 0.5150181 0.5170814 0.5184025 0.5194999 0.5207894 0.5219313 0.5230189 
##       80%       90% 
## 0.5241111 0.5258198</code></pre>
<p>the density histograms</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="x-is-uniform" class="section level3">
<h3><span class="math inline">\(X\)</span> is uniform:</h3>
<p>the mean:</p>
<p><code>## [1] 0.3333285</code> the median</p>
<pre><code>## [1] 0.3333709</code></pre>
<p>the deciles</p>
<pre><code>##       10%       20%       30%       40%       50%       60%       70% 
## 0.3301683 0.3312522 0.3321174 0.3327340 0.3333709 0.3340040 0.3346054 
##       80%       90% 
## 0.3353948 0.3363167</code></pre>
<p>the density histograms</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="x-is-bernoulli0.1" class="section level3">
<h3><span class="math inline">\(X\)</span> is Bernoulli(0.1):</h3>
<p>the mean:</p>
<p><code>## [1] 0.9001011</code> the median</p>
<pre><code>## [1] 0.9001</code></pre>
<p>the deciles</p>
<pre><code>##    10%    20%    30%    40%    50%    60%    70%    80%    90% 
## 0.8964 0.8976 0.8984 0.8993 0.9001 0.9008 0.9017 0.9026 0.9040</code></pre>
<p>the density histograms</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAulBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmkNtmtrZmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q29uQ2/+2ZgC2Zjq2ZpC2kDq2kGa229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb27bb29vb2//b////tmb/25D/27b//7b//9v///8CopTCAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKcElEQVR4nO2dC3fbNhaE6cSuvXXbTe2mu7Xcx6Y1091mGzZJK9kW///fKt4AnyOQFAVRM+ckx6TAudBH8AKkYTArqV5lh65A6iIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAeoyM4ezI/b++xiXSm1/fX9/qqwfXuVZa96S4jwzUq1FmtRnr3w+z9+m2XZy1d/7Rx9J0BPr1/sEdBGVDm76SmgwmNAXbUMAAkTrbPVrtHbAPWF2IP6IseE7yrm9zs+mS+KomfZyhX85W2WnT+4FvTHtSD9z3cygnGU7fPlv9R53KqyKrY48j+vsxfvyo+vRbkvhcHzbXb58To7uyv/uFKOgZmV81LutpLS9uzVunKEDv+7rFSLsQtqaxlYyMvn/I0HJFrL2Z345MOVazQmuvsOvl4mlju48Gg1oMJt29Bmj4Snz8XZtd99sd6Y1vsgvbWuLVpvVlbCCa8QkDnwvHJEFVDN2Ac1tQwsXIMxYcW2ifP4xd26BsjUxtfLxrr0Nb54J/+/0YAkwHX5QaHW5+DxyjjcqHpdrre55SaO/FMc9dlaFrpR3jfy2OxOlw/NdA0Dr6CR5/IkWotqeFupqnEQ1NTSW5hKvnWApGfjEtLRzXcI62VjrVxB+aPYawCJoue/+Xq/d9dyrs+q/FmU1oCsyaf/XUvkYr8+BRem8qFZ4FjaS9QAUtFlVV68b4S3gKrGQVBdLLCoVNKclWY2doBWtXqZWNm6UlBBVnXR7VNnHF9DU9D+XPmC2x9sm9SnSv+vahWamcbuvAJAoqy9YtrDN4yDoLpY1eIy+NIO0MYlihCQqkNYLxOr1ot5QKLX1IF+9udGxRP+K/tzCEh+pfOfPt22AQrNwsYuvQJAJqGolFIP3w4oCKqLBRaVSgZRewA1v2MPIPGtfry2eXSHFqRJPLcDCsz6W5Abn7SGbxgHQV0LshaVSpodMtJULUh7fu8v5u4cpMxVa/AZtg7ImZXBWW3moGoWDcK3AwqCVtu5D+JzkOvmt59etwOq5aBeQMLsa3WdqawuP+vuxWwLulg/3bfmoNDMtpX2XkwMcZ5u28J3tiAb1Ph4i0olbRNyelW2Aar2Yv0t6K1LB6pR9o2DXA7qStKhmQ3nvAJAZuwht+vhf+/MQTZJb8JxkLLMq+Og8FbjrmwFVB0HgUvsg0wBX8rBrxo221Hmv3Uoseurd41e7PxN4VtneIl5MyPvFQ72n34QvZAecNfC/9bdi+mgtpaBxfa/V9nLu8otyKdvr8LutAHI16sOaJByeId99BoIKFcXsTiJzaHpwjQQkB1ugPvwBWjoJfYkr+XK7flCxUeuQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQMcAKKtp3uCzRhumrHdz3uBJioCACAiIgIAWAGjaHqbeay0A0LR2dRMCAiYEBEwICJgQEDAhIGBCQMCEgIAJAQETAgImBARMCAiYEBAwISBgQkDAhICAyQIATfzArH/7GAFNa0dAkSZpAGpdIm643ZQmaQDSS+f0rRgaaTedSSqAygkYLR2QRjRi4daFA5KL3qzK7f3wVZOWDEgu/qXJbDqbkF0DrLPAggE93+LFkgqboDZdmWrJgL7RfLqbj2g/DkvRcRWeAKCiG9DzrV/Hu6PUYgHl/m6qu5tnC0Iq7Dqp0+YgMJsjEUA7ya7S3TkOGAYobjtlQPuxiwU066xX7f58e+OWix8yjh5X2ZEtaA5Au0rk8ks1WFx1FDhxQIVa/VotNztpko7bPhQg+aWLnvxruvmNGnBP2s0fCaBcvgnhssy7H5upgaIeIk46UDwOQPLbb0RuQbcaJ9uCJKBcLp/d04u5HBSMqTvsBtVht+2DXWKXz7dyze++J9Mn3YuJgZB8H8S4J/dLBnQ4OwKKPChRQPBxapzdiIMSBZRP8Ra6BQPqvHsYZjfmoFQBdXXdg+zGHJQmoLEdfM1uzEFpAlL3GYNdTuB50KgHZk27MQelCeiAdgQUeVCqgNRrIfNxnf2SAW3OHgp5Nz///KDjACQf8cjnPX3PgyLsxhyUJiA5UJSAep4oxtiNOShNQLYF5X2zp/YzP+g4AJkcVPQNF/c0P+hIAOmhYt8sqn3N7jgWQFD7mh+0GECn3YL0vVj//NZ9zQ+K2z4MoFx/96J/HnmS84NmAbTxL+we9dxsqYCCp2U9v5vvcVn686DgDmyHW42eVrZcQLADL4Nnat1j6dMGZDsvtqBOyekN6QHa66TOOEAih4vuLjVAU9ShUxYQzC5WYqR0goBi9Hj1koB6tb3vfiRCQJPYxf1txikC6j+IgAgorhQBgVIEBEoRECh1AoAi74NOD1CkHQHFlSIgUIqAQCkCAqUICJQiIFBqakCTPoFdIqAhVeoUAQHNAgj83oGA9vuNCeiIAA2cxHkygHadxIl+17lUQDtPwZv3G6cDqPsX1LW20mhBSWl/gHZoQctTZA5CkziXp7gGBydxLk8Tj4OWp70AOmwSRkoB0LTlDlJsYPFpTQlomnIElGKxgcWnNSWgacoRUIrFBhaf1pSApim3PEBLEgEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQ0ASANuG6VfItm2YdGbN307+sFbSruUTatbuV5ePn73dzGw9ILhzjFo8p5IYk5P6+vvJxrF3TJdKu3U3+ili/PwW7jQakZzSYNWP0KjJiQ6+WUlysKx/H2jVdIu3a3VTDkYB2cRsNSJ8Ss2aMA6RPi/i/8nGsXdMl0q7dTc69UPN3dnEbD+gfKqwJYi8xU5lsVf040q7pEmnX7lbafbu4jQbkz4ve1FnPnJtsVfs4zq7pEmnX7qY+kVR2cZsYkHy1wuPVjU2IIwE1XcYAcm7qk9kAVZppcFHnIg/+/5uHUZdY02XMJebcSrtvlkusIw/qzz6PzapteTN0GZOknZuq6WxJutJV6ojulIzt5psuY7p551baOs7SzdfGYiYHqbdwDRnZVcq3uIwYKHq30r1ob4aBohvAmzFQpl+GLGcz6shF5K1GaNfiEmnX7uZaOXbjzSoQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREFCigNRCRWoeRq5WbIn67f6kShOQmie3vVcTsRSm4mCEkgRkJjOrKRkaUPASxpmVJCD7xvJi5QGtxL/vbrO+d3XvRSkCClbbc5eYmt4jrrPZr7UUAQXrNdokLRO2usxGvig3XukCkmREltYtaJNd6t0VeHMoTUB2yVgHSE5+JCAnm6QDQAUBBbKJJmxBF2sC8tLrMueZGwfJP0EhoEDqVkPN1PW3GgSUpAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICOhvTuTj+mOcnNAAAAAASUVORK5CYII=" /><!-- --></p>
<p>R code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">GiniratioV &lt;-<span class="st"> </span><span class="cf">function</span>(X,<span class="dt">Xmean=</span><span class="ot">NA</span>){
  <span class="co">#vector X</span>
  <span class="cf">if</span>(<span class="kw">is.na</span>(Xmean)) Xmean=<span class="kw">mean</span>(X)
  sX &lt;-<span class="st"> </span><span class="kw">sort</span>(X)
  G=<span class="dv">0</span>
  n=<span class="kw">length</span>(X)
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
    G=G<span class="op">+</span>(<span class="dv">2</span><span class="op">*</span>i<span class="op">-</span>n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>sX[i]
  }
  G=G<span class="op">/</span>n<span class="op">/</span>n<span class="op">/</span>Xmean
  <span class="kw">return</span>(G)
}
N=<span class="dv">10000</span>
n=<span class="dv">1000</span>
<span class="kw">set.seed</span>(<span class="dv">1234</span>)
<span class="co"># standard lognormal</span>
<span class="co"># random numbers from  standard lognormal and calculate G</span>
<span class="co"># 10000 random numbers and 1000 times</span>

Gln &lt;-<span class="st"> </span><span class="kw">replicate</span>(n, <span class="dt">expr =</span> { 
  X&lt;-<span class="kw">rlnorm</span>(N)
  <span class="kw">GiniratioV</span>(X)
})
<span class="kw">mean</span>(Gln)</code></pre></div>
<pre><code>## [1] 0.5205809</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">median</span>(Gln)</code></pre></div>
<pre><code>## [1] 0.5207894</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">quantile</span>(Gln,<span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>))</code></pre></div>
<pre><code>##       10%       20%       30%       40%       50%       60%       70% 
## 0.5150181 0.5170814 0.5184025 0.5194999 0.5207894 0.5219313 0.5230189 
##       80%       90% 
## 0.5241111 0.5258198</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#hist(Gln,freq=F)</span>

<span class="co"># uniform </span>
<span class="co"># random numbers from uniform and calculate G</span>
<span class="co"># 10000 random numbers and 1000 times</span>

Gun &lt;-<span class="st"> </span><span class="kw">replicate</span>(n, <span class="dt">expr =</span> { 
  X&lt;-<span class="kw">runif</span>(N)
  <span class="kw">GiniratioV</span>(X)
})
<span class="kw">mean</span>(Gun)</code></pre></div>
<pre><code>## [1] 0.3333285</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">median</span>(Gun)</code></pre></div>
<pre><code>## [1] 0.3333709</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">quantile</span>(Gun,<span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>))</code></pre></div>
<pre><code>##       10%       20%       30%       40%       50%       60%       70% 
## 0.3301683 0.3312522 0.3321174 0.3327340 0.3333709 0.3340040 0.3346054 
##       80%       90% 
## 0.3353948 0.3363167</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#hist(Gun,freq=F)</span>

<span class="co"># Bernoulli(0.1). </span>
<span class="co"># random numbers from  Bernoulli(0.1).  and calculate G</span>
<span class="co"># 10000 random numbers and 1000 times</span>


GBN &lt;-<span class="st"> </span><span class="kw">replicate</span>(n, <span class="dt">expr =</span> { 
  X&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),N,<span class="dt">replace=</span>T,<span class="dt">p=</span><span class="kw">c</span>(<span class="fl">0.9</span>,<span class="fl">0.1</span>))
  <span class="kw">GiniratioV</span>(X)
})
<span class="kw">mean</span>(GBn)</code></pre></div>
<pre><code>## [1] 0.9001011</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">median</span>(GBn)</code></pre></div>
<pre><code>## [1] 0.9001</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">quantile</span>(GBn,<span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>))</code></pre></div>
<pre><code>##    10%    20%    30%    40%    50%    60%    70%    80%    90% 
## 0.8964 0.8976 0.8984 0.8993 0.9001 0.9008 0.9017 0.9026 0.9040</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#hist(GBn,freq=F)</span></code></pre></div>
</div>
</div>
<div id="q2-3" class="section level2">
<h2>Q2</h2>
<p>6.10 Construct an approximate 95% confidence intervalfor the Gini ratio <span class="math inline">\(?? = E[G]\)</span> if <span class="math inline">\(X\)</span> is lognormal with unknown parameters. Assess the coverage rate of the estimation procedure with a Monte Carlo experiment. ## A2 Based on that if <span class="math inline">\(X\)</span> is Log-normal distribution,<span class="math inline">\(E[G]=erf(\frac{\sigma}{2})\)</span></p>
<p>So I use the 95% confidence interval of variance of <span class="math inline">\(log(X)\)</span> to approximate variance of <span class="math inline">\(E[G]\)</span>the 95% con???dence interval of</p>
<p>for the normal distribution ,<span class="math inline">\((n-1)\frac{s^2}{\sigma^2} \sim \chi^2\)</span> so that the 95% confidence interval of <span class="math inline">\(\sigma^2\)</span> is <span class="math inline">\([\frac{(n-1)S^2}{\chi^2_{n-1}(1-\alpha\2)} \frac{(n-1)S^2}{\chi^2_{n-1}(\alpha\2)} ]\)</span> <span class="math inline">\(\alpha=0.05\)</span></p>
<p>function varCILN is to return the confidence interval of variance</p>
<p>function GCI is to return the confidence interval of <span class="math inline">\(?? = E[G]\)</span> of data x from log-normal</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">erfc &lt;-<span class="st"> </span><span class="cf">function</span>(s){
  <span class="kw">return</span>(<span class="dv">2</span><span class="op">*</span><span class="kw">pnorm</span>(s,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>))<span class="op">-</span><span class="dv">1</span>)
} 

varCILN &lt;-<span class="st"> </span><span class="cf">function</span>(x,a){
  <span class="co"># a level</span>
  <span class="co"># x data from log-normal</span>
  n &lt;-<span class="st"> </span><span class="kw">length</span>(x)
  ns_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">var</span>(<span class="kw">log</span>(x))<span class="op">*</span>n
  <span class="kw">return</span>(<span class="kw">c</span>(ns_<span class="dv">2</span><span class="op">/</span><span class="kw">qchisq</span>(<span class="dv">1</span><span class="op">-</span>a<span class="op">/</span><span class="dv">2</span>,n<span class="op">-</span><span class="dv">1</span>),ns_<span class="dv">2</span><span class="op">/</span><span class="kw">qchisq</span>(a<span class="op">/</span><span class="dv">2</span>,n<span class="op">-</span><span class="dv">1</span>)))
} 

GCI &lt;-<span class="st"> </span><span class="cf">function</span>(x,a){
  <span class="co"># a level</span>
  <span class="co"># x data from log-normal</span>
  ci &lt;-<span class="st"> </span><span class="kw">varCILN</span>(x,a)
  g1 &lt;-<span class="st"> </span><span class="kw">erfc</span>(<span class="kw">sqrt</span>(ci[<span class="dv">1</span>])<span class="op">/</span><span class="dv">2</span>)
  g2 &lt;-<span class="st"> </span><span class="kw">erfc</span>(<span class="kw">sqrt</span>(ci[<span class="dv">2</span>])<span class="op">/</span><span class="dv">2</span>)
  <span class="kw">return</span>(<span class="kw">c</span>(g1,g2))
}</code></pre></div>
<p>MC :</p>
<p>I generate 100 random numbers from log-normal(0,1) 10000 times</p>
<p>coverage:</p>
<p>I estimate the ture CI from first simulation</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">100</span>)
N=<span class="dv">100</span>
n=<span class="dv">10000</span>
X &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(N)
gci &lt;-<span class="st"> </span><span class="kw">GCI</span>(X,<span class="fl">0.05</span>)
gci</code></pre></div>
<pre><code>## [1] 0.4758068 0.6005839</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">g &lt;-<span class="st"> </span><span class="kw">replicate</span>(n, <span class="dt">expr =</span> { 
  X &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(N)
  <span class="kw">erfc</span>(<span class="kw">sd</span>(<span class="kw">log</span>(X))<span class="op">/</span><span class="dv">2</span>)
})
<span class="kw">sum</span>(gci[<span class="dv">1</span>]<span class="op">&lt;</span>g <span class="op">&amp;</span><span class="st"> </span>gci[<span class="dv">2</span>]<span class="op">&gt;</span>g)<span class="op">/</span>n</code></pre></div>
<pre><code>## [1] 0.9077</code></pre>
<p>I estimate the CI from ftheory:</p>
<p><code>r   a=0.05   ns_2&lt;-N-1   ci &lt;- c(ns_2/qchisq(1-a/2,N-1),ns_2/qchisq(a/2,N-1))   g1 &lt;- erfc(sqrt(ci[1])/2)   g2 &lt;- erfc(sqrt(ci[2])/2)   gci_2 &lt;-c(g1,g2)   sum(gci_2[1]&lt;g &amp; gci_2[2]&gt;g)/n</code></p>
<p><code>## [1] 0.94</code></p>
</div>
<div id="q3-2" class="section level2">
<h2>Q3</h2>
<p>6.B Tests for association based on Pearson product moment correlation <span class="math inline">\(\rho\)</span>, Spearman???s rank correlation coefficient <span class="math inline">\(\rho_s\)</span>, or Kendall???s coefficient <span class="math inline">\(\tau\)</span> are implemented in cor.test. Show (empirically) that the nonparametric tests based on <span class="math inline">\(\rho_s\)</span> or <span class="math inline">\(\tau\)</span> are less powerful than the correlation test when the sampled distribution is bivariate normal. Find an example of an alternative (a bivariate distribution <span class="math inline">\((X,Y)\)</span> such that X and Y are dependent) such that at least one of the nonparametric tests have better empirical power than the correlation test against this alternative. ## A3 Show (empirically) that the nonparametric tests based on <span class="math inline">\(\rho_s\)</span> or <span class="math inline">\(\tau\)</span> are less powerful than the correlation test when the sampled distribution is bivariate normal</p>
<p>Find an example of an alternative (a bivariate distribution <span class="math inline">\((X,Y)\)</span> such that X and Y are dependent) such that at least one of the nonparametric tests have better empirical power than the correlation test against this alternative.</p>
<p>I generate 100 random numbers from bivariate normal ( both means are 0 and variances are 1 , coefficient of association is 0.4),and repeat 10000 times to show how much ratio or the power the p-value of tests are less than 0.05, which means the test shows that true correlation is not equal to 0 and ia “right”</p>
<pre><code>## Warning: 程辑包'MASS'是用R版本3.5.2 来建造的</code></pre>
<p>Using Pearson product moment correlation <span class="math inline">\(\rho\)</span>,how many times the p-value of tests are more than 0.05 in 10000 simulation</p>
<pre><code>## [1] 0.9875</code></pre>
<p>nonparametric:</p>
<p>Using Kendall???s coefficien <span class="math inline">\(\tau\)</span>,how many times the p-value of tests are more than 0.05 in 10000 simulation</p>
<pre><code>## [1] 0.9779</code></pre>
<p>nonparametric:</p>
<p>Using Spearman???s rank correlation coefficient <span class="math inline">\(\rho_s\)</span>,how many times the p-value of tests are more than 0.05 in 10000 simulation</p>
<pre><code>## [1] 0.9782</code></pre>
<p>It shows that nonparametric tests all have less power than Pearson product moment correlation</p>
<p>P2: <span class="math inline">\(\vec{X}\)</span> is from dirichlet(3,1)</p>
<p><span class="math inline">\(\vec{Z}\)</span> is from dirichlet(1,3) and id independant with <span class="math inline">\(\vec{X}\)</span></p>
<p><span class="math inline">\(Y=0.18X+0.5Z\)</span> also is a vector</p>
<p>I generate 100 random numbers 10000 times and test 10000 times</p>
<p>I consider the association between <span class="math inline">\(x_2\)</span> and Y<span class="math inline">\(_1\)</span> ,of course, they are dependant and the true correlation is nearby 0.34</p>
<pre><code>## 载入需要的程辑包：Formula</code></pre>
<pre><code>## 载入需要的程辑包：rgl</code></pre>
<p>Using Pearson product moment correlation <span class="math inline">\(\rho\)</span>,how many times the p-value of tests are more than 0.05 in 10000 simulation</p>
<pre><code>## [1] 0.9348</code></pre>
<p>nonparametric:</p>
<p>Using Kendall???s coefficient <span class="math inline">\(\tau\)</span>,how many times the p-value of tests are more than 0.05 in 10000 simulation</p>
<pre><code>## [1] 0.9397</code></pre>
<p>nonparametric:</p>
<p>Using Spearman???s rank correlation coefficient <span class="math inline">\(\rho_s\)</span>,how many times the p-value of tests are more than 0.05 in 10000 simulation</p>
<pre><code>## [1] 0.9356</code></pre>
<p>It shows that nonparametric tests all have more power than Pearson product moment correlation</p>
<p>R code :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#cor.test(x,y,method=&quot;pearson&quot;)  Pearson product moment correlation ??,</span>
<span class="co">#cor.test(x,y,method=&quot;kendall&quot;)  Kendall???s coe???cient ??</span>
<span class="co">#cor.test(x,y,method=&quot;spearman&quot;) Spearman???s rank correlation coe???cient ??s</span>

cortestall &lt;-<span class="st"> </span><span class="cf">function</span>(x,y){
  t1&lt;-<span class="kw">cor.test</span>(x,y,<span class="dt">method=</span><span class="st">&quot;pearson&quot;</span>)
  t2&lt;-<span class="kw">cor.test</span>(x,y,<span class="dt">method=</span><span class="st">&quot;kendall&quot;</span>)
  t3&lt;-<span class="kw">cor.test</span>(x,y,<span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>) 
  Assc &lt;-<span class="st"> </span><span class="kw">c</span>(t1<span class="op">$</span>p.value,t2<span class="op">$</span>p.value,t3<span class="op">$</span>p.value)
  <span class="kw">return</span>(Assc)
}

<span class="kw">library</span>(MASS)
<span class="kw">set.seed</span>(<span class="dv">12</span>)
N=<span class="dv">100</span>
n=<span class="dv">10000</span>
mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)
p &lt;-<span class="st"> </span><span class="fl">0.4</span>
Var &lt;-<span class="st"> </span><span class="dv">1</span>
sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,p,p,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)
testn &lt;-<span class="st"> </span><span class="kw">replicate</span>(n, <span class="dt">expr =</span> { 
  X &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(N,mu,Var<span class="op">*</span>sigma)
  <span class="kw">cortestall</span>(X[,<span class="dv">1</span>],X[,<span class="dv">2</span>])
})
<span class="kw">sum</span>(testn[<span class="dv">1</span>,]<span class="op">&lt;=</span><span class="fl">0.05</span>)<span class="op">/</span>n</code></pre></div>
<pre><code>## [1] 0.9875</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(testn[<span class="dv">2</span>,]<span class="op">&lt;=</span><span class="fl">0.05</span>)<span class="op">/</span>n</code></pre></div>
<pre><code>## [1] 0.9779</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(testn[<span class="dv">3</span>,]<span class="op">&lt;=</span><span class="fl">0.05</span>)<span class="op">/</span>n</code></pre></div>
<pre><code>## [1] 0.9782</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages(&quot;DirichletReg&quot;)</span>
<span class="kw">library</span>(DirichletReg)

N=<span class="dv">100</span>
n=<span class="dv">10000</span>

testn &lt;-<span class="st"> </span><span class="kw">replicate</span>(n, <span class="dt">expr =</span> { 
  X &lt;-<span class="st"> </span><span class="kw">rdirichlet</span>(N,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))
  Z &lt;-<span class="st"> </span><span class="kw">rdirichlet</span>(N,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))
  Y &lt;-<span class="st"> </span><span class="fl">0.18</span><span class="op">*</span>X <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span><span class="op">*</span>Z
  <span class="kw">cortestall</span>(X[,<span class="dv">2</span>],Y[,<span class="dv">1</span>])
})
<span class="kw">sum</span>(testn[<span class="dv">1</span>,]<span class="op">&lt;=</span><span class="fl">0.05</span>)<span class="op">/</span>n</code></pre></div>
<pre><code>## [1] 0.9348</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(testn[<span class="dv">2</span>,]<span class="op">&lt;=</span><span class="fl">0.05</span>)<span class="op">/</span>n</code></pre></div>
<pre><code>## [1] 0.9397</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(testn[<span class="dv">3</span>,]<span class="op">&lt;=</span><span class="fl">0.05</span>)<span class="op">/</span>n</code></pre></div>
<pre><code>## [1] 0.9356</code></pre>
</div>
<div id="h5-a-18033-2018-11-02" class="section level2">
<h2>H5 A-18033-2018-11-02</h2>
</div>
<div id="q1-4" class="section level2">
<h2>Q1</h2>
<p>7.1 Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
<div id="a1-4" class="section level2">
<h2>A1</h2>
<p>I compute the jackknife replicates, leave-one-out estimates. The process is same as the book’s. A jackknife estimate of the bias and the standard error of the correlation is shown bellow.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages(&quot;bootstrap&quot;)</span>
<span class="kw">library</span>(bootstrap)</code></pre></div>
<pre><code>## Warning: 程辑包'bootstrap'是用R版本3.5.2 来建造的</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DAAG)</code></pre></div>
<pre><code>## Warning: 程辑包'DAAG'是用R版本3.5.2 来建造的</code></pre>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：'DAAG'</code></pre>
<pre><code>## The following object is masked from 'package:MASS':
## 
##     hills</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(law)


<span class="co">#compute the jackknife replicates, leave-one-out estimates </span>
<span class="kw">set.seed</span>(<span class="dv">4321</span>)
n &lt;-<span class="st"> </span><span class="kw">length</span>(law[,<span class="dv">1</span>])
theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n) 
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) 
theta.jack[i] &lt;-<span class="st"> </span><span class="kw">cor</span>(law[<span class="op">-</span>i,])[<span class="dv">1</span>,<span class="dv">2</span>]
bias &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta.jack) <span class="op">-</span><span class="st"> </span><span class="kw">cor</span>(law)[<span class="dv">1</span>,<span class="dv">2</span>])
bias</code></pre></div>
<pre><code>## [1] -0.006473623</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mjack &lt;-<span class="st"> </span><span class="kw">mean</span>(theta.jack)
se.jack &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>n<span class="op">*</span><span class="kw">sum</span>((theta.jack<span class="op">-</span>mjack)<span class="op">^</span><span class="dv">2</span>))
se.jack</code></pre></div>
<pre><code>## [1] 0.1425186</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="dt">original=</span><span class="kw">cor</span>(law)[<span class="dv">1</span>,<span class="dv">2</span>],<span class="dt">bias=</span>bias,<span class="dt">se=</span>se.jack)</code></pre></div>
<pre><code>##     original         bias           se 
##  0.776374491 -0.006473623  0.142518619</code></pre>
</div>
<div id="q2-4" class="section level2">
<h2>Q2</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures 1/?? by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
<p>The 12 observations are the times in hours between failures of airconditioning equipment [63, Example 1.1]: 3,5,7,18,43,85,91,98,100,130,230,487</p>
</div>
<div id="a2-2" class="section level2">
<h2>A2</h2>
<p>Compare the intervals and explain why they may differ.:</p>
<p>The intervals are shown bellow.</p>
<p>the the bootstrap has its distribution only dependented on the data,and it is random, so that they may be</p>
<p>different . Also, the methods base on different things.</p>
<p>the standard normal: it bases on the asymptotic normal assumption,</p>
<p>basic :it bases on quantile of the difference between an estimator and the parameter</p>
<p>percentile :it seems that bootstrap answer is just like the distrubution of parameter</p>
<p>BCa methods : it bases on the asymptotic normal assumption, but correct some bias</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages(&quot;boot&quot;)</span>
<span class="kw">library</span>(boot)</code></pre></div>
<pre><code>## 
## 载入程辑包：'boot'</code></pre>
<pre><code>## The following object is masked from 'package:lattice':
## 
##     melanoma</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(aircondit)
<span class="kw">set.seed</span>(<span class="dv">4321</span>)
<span class="co">#set up the bootstrap </span>
B &lt;-<span class="st"> </span><span class="dv">2000</span> <span class="co">#number of replicates </span>
n &lt;-<span class="st"> </span><span class="kw">nrow</span>(aircondit) <span class="co">#sample size </span>
a &lt;-<span class="st"> </span><span class="fl">0.05</span> <span class="co">#level</span>
meantime &lt;-<span class="st"> </span><span class="kw">numeric</span>(B) <span class="co">#storage for replicates</span>
<span class="co">#bootstrap estimate of standard error of R </span>

meanairc &lt;-<span class="st"> </span><span class="kw">mean</span>(aircondit[,<span class="dv">1</span>]) <span class="co">#mean of the original observed sample</span>
<span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B) { 
<span class="co">#randomly select the indices </span>
i &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>) 
Bairc &lt;-<span class="st"> </span>aircondit[i,<span class="dv">1</span>]
meantime[b] &lt;-<span class="st"> </span><span class="kw">mean</span>(Bairc)
}
mmean &lt;-<span class="st"> </span><span class="kw">mean</span>(meantime)  <span class="co">#mean of the bootstrap replicate</span>
SEmeantime &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">sum</span>((meantime<span class="op">-</span>mmean)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(B<span class="op">-</span><span class="dv">1</span>))

<span class="co">#the standard normal</span>
the_standard_normalCI &lt;-<span class="st"> </span><span class="kw">c</span>(meanairc<span class="op">-</span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>a<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>SEmeantime,meanairc<span class="op">+</span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>a<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>SEmeantime)
<span class="kw">names</span>(the_standard_normalCI) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;2.5%&quot;</span>,<span class="st">&quot;97.5%&quot;</span>)

<span class="co">#basic</span>
percentileCI &lt;-<span class="st"> </span><span class="kw">quantile</span>(meantime,<span class="dt">probs=</span><span class="kw">c</span>(a<span class="op">/</span><span class="dv">2</span>,<span class="dv">1</span><span class="op">-</span>a<span class="op">/</span><span class="dv">2</span>)) 
basic_CI &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span><span class="op">*</span>meanairc<span class="op">-</span>percentileCI[<span class="dv">2</span>],<span class="dv">2</span><span class="op">*</span>meanairc<span class="op">-</span>percentileCI[<span class="dv">1</span>])

<span class="co">#percentile</span>
<span class="co">#percentileCI</span>

<span class="co">#Bca</span>
x &lt;-<span class="st"> </span>aircondit[,<span class="dv">1</span>]
alpha &lt;-<span class="st"> </span><span class="kw">c</span>(a<span class="op">/</span><span class="dv">2</span>,<span class="dv">1</span><span class="op">-</span>a<span class="op">/</span><span class="dv">2</span>)
zalpha &lt;-<span class="st"> </span><span class="kw">qnorm</span>(alpha)
z0 &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="kw">sum</span>(meantime <span class="op">&lt;</span><span class="st"> </span>mmean) <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(meantime))
mean.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {
mean.jack[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(x[<span class="op">-</span>i]) 
} 
L &lt;-<span class="st"> </span><span class="kw">mean</span>(mean.jack) <span class="op">-</span><span class="st"> </span>mean.jack 
sa &lt;-<span class="st"> </span><span class="kw">sum</span>(L<span class="op">^</span><span class="dv">3</span>)<span class="op">/</span>(<span class="dv">6</span> <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(L<span class="op">^</span><span class="dv">2</span>)<span class="op">^</span><span class="fl">1.5</span>)
adj.alpha &lt;-<span class="st"> </span><span class="kw">pnorm</span>(z0 <span class="op">+</span><span class="st"> </span>(z0<span class="op">+</span>zalpha)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>sa<span class="op">*</span>(z0<span class="op">+</span>zalpha))) 
BCa_CI &lt;-<span class="st"> </span><span class="kw">quantile</span>(meantime, adj.alpha, <span class="dt">type=</span><span class="dv">6</span>)


<span class="co">#the standard normal</span>
the_standard_normalCI</code></pre></div>
<pre><code>##      2.5%     97.5% 
##  35.25234 180.91433</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#the standard normal</span>
basic_CI</code></pre></div>
<pre><code>##     97.5%      2.5% 
##  30.73333 169.00208</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#percentile</span>
percentileCI</code></pre></div>
<pre><code>##      2.5%     97.5% 
##  47.16458 185.43333</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Bca</span>
BCa_CI</code></pre></div>
<pre><code>## 7.258344% 99.64576% 
##  58.58333 235.05621</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#another </span>
x=aircondit<span class="op">$</span>hours
meanx&lt;-<span class="cf">function</span>(x,i) <span class="kw">mean</span>(x[i])
de &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>x,<span class="dt">statistic=</span>meanx, <span class="dt">R =</span>B)
ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))
ci</code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = de, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 35.1, 183.7 )   ( 24.8, 168.9 )  
## 
## Level     Percentile            BCa          
## 95%   ( 47.3, 191.4 )   ( 56.5, 227.7 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
</div>
<div id="q3-3" class="section level2">
<h2>Q3</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat\theta\)</span>.</p>
</div>
<div id="a3-2" class="section level2">
<h2>A3</h2>
<p>Same as the Q1</p>
<p>I compute the jackknife replicates, leave-one-out estimates.</p>
<p>A jackknife estimate of the bias and the standard error of the correlation is shown bellow.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attach</span>(scor)
datascores  &lt;-scor
n &lt;-<span class="st"> </span><span class="kw">length</span>(datascores[,<span class="dv">1</span>])
theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n) 
calthta &lt;-<span class="st"> </span><span class="cf">function</span>(X){
<span class="co">#X show be a matrix n*n</span>
eig &lt;-<span class="st"> </span><span class="kw">eigen</span>(X)
sort_eig &lt;-<span class="st"> </span><span class="kw">sort</span>(eig<span class="op">$</span>values,<span class="dt">decreasing=</span>T)
<span class="kw">return</span>(sort_eig[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(sort_eig))
}

<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) theta.jack[i] &lt;-<span class="st"> </span><span class="kw">calthta</span>(<span class="kw">cov</span>(datascores[<span class="op">-</span>i,]))
bias &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta.jack) <span class="op">-</span><span class="st"> </span><span class="kw">calthta</span>(<span class="kw">cov</span>(datascores)))
bias</code></pre></div>
<pre><code>## [1] 0.001069139</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mjack &lt;-<span class="st"> </span><span class="kw">mean</span>(theta.jack)
sc.jack &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>n<span class="op">*</span><span class="kw">sum</span>((theta.jack<span class="op">-</span>mjack)<span class="op">^</span><span class="dv">2</span>))
sc.jack</code></pre></div>
<pre><code>## [1] 0.04955231</code></pre>
</div>
<div id="q4-1" class="section level2">
<h2>Q4</h2>
<p>7.11 In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
<div id="a4-1" class="section level2">
<h2>A4</h2>
<p>Also Chosse moderl 2</p>
<p>The fitted regression equation for Model 2 is <span class="math inline">\(\hat Y = 24 .49262???1.39334X +0 .05452X^2\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages(&quot;DAAG&quot;)</span>
<span class="co">#install.packages(&quot;caTools&quot;)</span>
<span class="kw">library</span>(DAAG)
<span class="kw">library</span>(caTools)
<span class="kw">attach</span>(ironslag)
n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag </span>
K=<span class="dv">2</span> <span class="co"># knife number</span>
kjack &lt;-<span class="st"> </span><span class="kw">combs</span>(<span class="dv">1</span><span class="op">:</span>n,K) <span class="co">#create the all combinations of 2 elements from 1:n</span>
N &lt;-<span class="st"> </span><span class="kw">choose</span>(n,K) <span class="co">#number of K</span>
e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">matrix</span>(,N,K)

<span class="co"># for n-fold cross validation </span>
<span class="co"># fit models on leave-two-out samples </span>


<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { 
k &lt;-<span class="st"> </span>kjack[i,]
y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>k] 
x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>k]
J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x) 
yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] 
e1[i,] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1
J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)) 
yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span> 
e2[i,] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2
J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x) 
logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] 
yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3) 
e3[i,] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3
J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x)) 
logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[k]) 
yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4) 
e4[i,] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4
}

<span class="kw">c</span>(<span class="kw">sum</span>(e1<span class="op">^</span><span class="dv">2</span>),<span class="kw">sum</span>(e2<span class="op">^</span><span class="dv">2</span>),<span class="kw">sum</span>(e3<span class="op">^</span><span class="dv">2</span>),<span class="kw">sum</span>(e4<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>N<span class="op">/</span>K</code></pre></div>
<pre><code>## [1] 19.57227 17.87018 18.45491 20.46718</code></pre>
</div>
<div id="h6-a-18033-2018-11-16" class="section level2">
<h2>H6 A-18033-2018-11-16</h2>
</div>
<div id="q1-5" class="section level2">
<h2>Q1</h2>
<p>8.1 Implement the two-sample Cramer-von Mises test for equal distributions as a permutation test. Apply the test to the data in Examples 8.1 and 8.2.</p>
</div>
<div id="a1-5" class="section level2">
<h2>A1</h2>
<p>Here the sample evidence supports the alternative hypothesis that the distributions di???er.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages(&quot;RANN&quot;)</span>
<span class="co">#install.packages(&quot;energy&quot;)</span>
<span class="co">#install.packages(&quot;devtools&quot;)</span>
<span class="co">#install.packages(&quot;Ball&quot;)</span>
<span class="kw">library</span>(RANN)</code></pre></div>
<pre><code>## Warning: 程辑包'RANN'是用R版本3.5.2 来建造的</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(boot) 
<span class="kw">library</span>(energy) </code></pre></div>
<pre><code>## Warning: 程辑包'energy'是用R版本3.5.2 来建造的</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Ball) </code></pre></div>
<pre><code>## Warning: 程辑包'Ball'是用R版本3.5.2 来建造的</code></pre>
<pre><code>## 
## 载入程辑包：'Ball'</code></pre>
<pre><code>## The following object is masked from 'package:DirichletReg':
## 
##     ArcticLake</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(devtools) </code></pre></div>
<pre><code>## Warning: 程辑包'devtools'是用R版本3.5.2 来建造的</code></pre>
<pre><code>## Warning: 程辑包'usethis'是用R版本3.5.2 来建造的</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#8.1</span>
<span class="kw">attach</span>(chickwts) 
<span class="kw">set.seed</span>(<span class="dv">1234</span>)
x &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">as.vector</span>(weight[feed <span class="op">==</span><span class="st"> &quot;soybean&quot;</span>])) 
y &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">as.vector</span>(weight[feed <span class="op">==</span><span class="st"> &quot;linseed&quot;</span>])) 
cvMTS &lt;-<span class="st"> </span><span class="cf">function</span>(X,Y){
<span class="co">#Cram??r???von Mises Two Sample  statistic</span>
<span class="co">#X  Y : vector</span>
XYrank &lt;-<span class="st"> </span><span class="kw">rank</span>(<span class="kw">c</span>(X,Y))
N &lt;-<span class="st"> </span><span class="kw">length</span>(X)
M &lt;-<span class="st"> </span><span class="kw">length</span>(Y)
U=<span class="st"> </span>N<span class="op">*</span><span class="kw">sum</span>((XYrank[<span class="dv">1</span><span class="op">:</span>N]<span class="op">-</span><span class="dv">1</span><span class="op">:</span>N)<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span>M<span class="op">*</span><span class="kw">sum</span>((XYrank[(N<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(N<span class="op">+</span>M)]<span class="op">-</span><span class="dv">1</span><span class="op">:</span>M)<span class="op">^</span><span class="dv">2</span>)
T=U<span class="op">/</span>M<span class="op">/</span>N<span class="op">/</span>(N<span class="op">+</span>M)<span class="op">-</span>(<span class="dv">4</span><span class="op">*</span>M<span class="op">*</span>N<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">6</span><span class="op">/</span>(M<span class="op">+</span>N)
<span class="kw">return</span>(T)
}
## start the replicate
R &lt;-<span class="st"> </span><span class="dv">999</span> <span class="co">#number of replicates </span>
z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y) <span class="co">#pooled sample </span>
K &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(z)
T &lt;-<span class="st"> </span><span class="kw">numeric</span>(R) <span class="co">#storage for replicates options(warn = -1) </span>
T0 &lt;-<span class="st"> </span><span class="kw">cvMTS</span>(x,y)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) { 
<span class="co">#generate indices k for the first sample </span>
k &lt;-<span class="st"> </span><span class="kw">sample</span>(K, <span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>) 
x1 &lt;-<span class="st"> </span>z[k] 
y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>k]
T[i] &lt;-<span class="st"> </span><span class="kw">cvMTS</span>(x1,y1)
}
P0 &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(T0, T) <span class="op">&gt;=</span><span class="st"> </span>T0)   
pvalue &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="dv">2</span><span class="op">*</span>P0,<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>P0))
pvalue</code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#pvalue &lt; 0.05</span>
<span class="co">#Thus, none of the replicates are as large as the observed test statistic. </span>
<span class="co">#Here the sample evidence supports the alternative hypothesis that the distributions di???er. </span>
<span class="kw">detach</span>(chickwts)</code></pre></div>
</div>
<div id="q2-5" class="section level2">
<h2>Q2</h2>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations. I Unequal variances and equal expectations I Unequal variances and unequal expectations I Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions) I Unbalanced samples (say, 1 case versus 10 controls) I Note: The parameters should be choosen such that the powers are distinguishable (say, range from 0.3 to 0.9).</p>
</div>
<div id="a2-3" class="section level2">
<h2>A2</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#PLUS</span>

<span class="co">#NN</span>
Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {
n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]
n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]
n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2 
<span class="cf">if</span>(<span class="kw">is.vector</span>(z))  z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>)
z &lt;-<span class="st"> </span>z[ix, ]
NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) 
block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>] 
block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>] 
i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>.<span class="dv">5</span>)
i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="op">+</span>.<span class="dv">5</span>) 
<span class="kw">return</span>((i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n) )
}

NNtest_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="cf">function</span>(x,y,<span class="dt">NumR=</span><span class="dv">999</span>,<span class="dt">k=</span><span class="dv">3</span>){
N &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">length</span>(x), <span class="kw">length</span>(y)) 
z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y)
boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> Tn, <span class="dt">R =</span> NumR, <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> N,<span class="dt">k=</span>k)
ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t) 
p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])
<span class="kw">return</span>(p.value)
}

<span class="co">#Energy test </span>
Energy_test &lt;-<span class="st"> </span><span class="cf">function</span>(x,y,<span class="dt">NumR=</span><span class="dv">999</span>){
N &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">length</span>(x), <span class="kw">length</span>(y)) 
z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y)
boot.obs &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z, <span class="dt">sizes=</span>N, <span class="dt">R=</span>NumR) 
p.value &lt;-<span class="st"> </span>boot.obs<span class="op">$</span>p.value
<span class="kw">return</span>(p.value)
}


<span class="co">#install_github(&quot;Mamba413/Ball&quot;, build_vignettes = TRUE)</span>

<span class="co">#</span>
alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>; 

##1
##Unequal variances and equal expectations
<span class="kw">set.seed</span>(<span class="dv">123</span>)
m &lt;-<span class="st"> </span><span class="dv">1000</span>; <span class="co">#number od tests</span>
k&lt;-<span class="dv">3</span>; 
p&lt;-<span class="dv">2</span>; 
mu &lt;-<span class="st"> </span><span class="dv">0</span>; 
n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">20</span>; 
R&lt;-<span class="dv">999</span>;
sigma1 &lt;-<span class="st"> </span><span class="dv">1</span> 
sigma2 &lt;-<span class="st"> </span><span class="fl">2.5</span>
<span class="co">#x N(0,1) 20 y N(0,4) 20</span>
p.values1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>) 
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){ 
x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,mu,sigma1)
y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,mu,sigma2)
z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y) 
p.values1[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">NNtest_1</span>(x,y,R,k) 
p.values1[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">Energy_test</span>(x,y,R)
p.values1[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(x,y,<span class="dt">R=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">123</span>)<span class="op">$</span>p.value 
}
pow1 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values1<span class="op">&lt;</span>alpha)
pow1</code></pre></div>
<pre><code>## [1] 0.482 0.504 0.777</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##2
##Unequal variances and unequal expectations
<span class="kw">set.seed</span>(<span class="dv">123</span>)
m &lt;-<span class="st"> </span><span class="dv">1000</span>; <span class="co">#number od tests</span>
k&lt;-<span class="dv">3</span>; 
p&lt;-<span class="dv">2</span>; 
mu1 &lt;-<span class="st"> </span><span class="dv">0</span>; 
mu2 &lt;-<span class="st"> </span><span class="dv">1</span>
n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">20</span>; 
R&lt;-<span class="dv">999</span>;
sigma1 &lt;-<span class="dv">1</span>
sigma2 &lt;-<span class="dv">2</span>
R&lt;-<span class="dv">100</span>;
<span class="co">#x N(0,1) 20  y N(1,4) 20</span>
p.values2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>) 
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){ 
x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,mu1,sigma1)
y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,mu2,sigma2)
z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y) 
p.values2[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">NNtest_1</span>(x,y,R,k) 
p.values2[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">Energy_test</span>(x,y,R)
p.values2[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(x,y,<span class="dt">R=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">123</span>)<span class="op">$</span>p.value 
}
pow2 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values2<span class="op">&lt;</span>alpha)
pow2</code></pre></div>
<pre><code>## [1] 0.433 0.679 0.711</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##3.1
##Non-normal distributions: t distribution with 1 df (heavy-tailed distribution),bimodel distribution (mixture of two normal distributions)
<span class="kw">set.seed</span>(<span class="dv">123</span>)
m &lt;-<span class="st"> </span><span class="dv">1000</span>; <span class="co">#number od tests</span>
k&lt;-<span class="dv">3</span>; 
n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">20</span>; 
df=<span class="dv">1</span>
R&lt;-<span class="dv">999</span>;
p=<span class="fl">0.4</span>
mu1 =<span class="op">-</span><span class="dv">1</span>
mu2 =<span class="st"> </span><span class="dv">1</span>
sigma1 =<span class="dv">1</span>
sigma2=<span class="dv">1</span>
<span class="co">#x t1 30  y 0.3N(-1,1)+0.7N(1,2) 30</span>
p.values3 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>) 
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){ 
x &lt;-<span class="st"> </span><span class="kw">rt</span>(n1,<span class="dt">df=</span>df)
y &lt;-<span class="st"> </span><span class="fl">0.3</span> <span class="op">*</span><span class="st"> </span><span class="kw">rnorm</span>(n2,mu1,sigma1) <span class="op">+</span><span class="st"> </span><span class="fl">0.7</span><span class="op">*</span><span class="kw">rnorm</span>(n2,mu2,sigma2)
z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y) 
p.values3[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">NNtest_1</span>(x,y,R,k) 
p.values3[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">Energy_test</span>(x,y,R)
p.values3[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(x,y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">123</span>)<span class="op">$</span>p.value 
}
pow3 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values3<span class="op">&lt;</span>alpha)
pow3</code></pre></div>
<pre><code>## [1] 0.344 0.606 0.688</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#4</span>
<span class="co">#Unbalanced samples (say, 1 case versus 10 controls)</span>
<span class="kw">set.seed</span>(<span class="dv">123</span>)
m &lt;-<span class="st"> </span><span class="dv">1000</span>; <span class="co">#number od tests</span>
k&lt;-<span class="dv">3</span>; 
n1 &lt;-<span class="st"> </span><span class="dv">100</span>; 
n2 &lt;-<span class="st"> </span><span class="dv">100</span><span class="op">/</span><span class="dv">10</span>
R&lt;-<span class="dv">999</span>;
mu1 =<span class="op">-</span><span class="dv">1</span>
mu2 =<span class="st"> </span><span class="dv">0</span>
sigma1 =<span class="dv">1</span>
sigma2=<span class="dv">2</span>
<span class="co">#x N(-1,1) 100  y N(1,2) 10</span>
p.values4 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>) 
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){ 
x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,mu1,sigma1)
y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,mu2,sigma2)
z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y) 
p.values4[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">NNtest_1</span>(x,y,R,k) 
p.values4[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">Energy_test</span>(x,y,R)
p.values4[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(x,y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">123</span>)<span class="op">$</span>p.value 
}
pow4 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values4<span class="op">&lt;</span>alpha)
pow4</code></pre></div>
<pre><code>## [1] 0.577 0.797 0.572</code></pre>
</div>
<div id="q3-4" class="section level2">
<h2>Q3</h2>
<p>9.3 Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the ???rst 1000 of the chain, and compare the deciles of the generated observations with the deciles of the standard Cauchydistribution(seeqcauchyorqtwithdf=1). RecallthataCauchy(??,??) distribution has density function</p>
<p><span class="math inline">\(f(x)=\frac{1}{\theta??(1+[(x???\eta)/\theta]^2}\)</span>, <span class="math inline">\(-\infty&lt;x&lt;\infty\)</span> <span class="math inline">\(\theta&gt;0\)</span>.</p>
<p>The standard Cauchy has the Cauchy(?? =1,??= 0) density. (Note that the standard Cauchy density is equal to the Student t density with one degree of freedom.)</p>
</div>
<div id="a3-3" class="section level2">
<h2>A3</h2>
<p>it is unavoidable that there is differ between MCMC estimations and theoretical value ,beacese of only 5000 samplers</p>
<p>For the variances of 10% or 90% quantile is remarkable larger than median and nearby quantiles , It can be found that differ of quantiles of two sides are large,but the estimation of median is seem great.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#9.3</span>
<span class="co">#the proposal distributio:normal</span>
theta=<span class="dv">1</span>
eta=<span class="dv">0</span>
MCMC &lt;-<span class="st"> </span><span class="cf">function</span>(N,theta,eta,<span class="dt">ssigma=</span><span class="dv">1</span>,<span class="dt">xstart=</span><span class="dv">0</span>,LM){
<span class="co">#  k=0</span>
mchain &lt;-<span class="st"> </span><span class="kw">numeric</span>(N) 
mchain[<span class="dv">1</span>] &lt;-<span class="st"> </span>xstart
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(N<span class="op">-</span><span class="dv">1</span>)){
r &lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>,mchain[i],ssigma)
a =<span class="st"> </span><span class="kw">LM</span>(r,theta,eta) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(mchain[i],<span class="dt">mean=</span>r,<span class="dt">sd=</span>ssigma) <span class="op">/</span><span class="st"> </span><span class="kw">LM</span>(mchain[i],theta,eta) <span class="op">/</span><span class="st"> </span><span class="kw">dnorm</span>(r,<span class="dt">mean=</span>mchain[i],<span class="dt">sd=</span>ssigma)
nr &lt;-<span class="kw">runif</span>(<span class="dv">1</span>)
<span class="co">#    if(nr&lt;a) k=k+1</span>
<span class="cf">if</span>(nr<span class="op">&lt;</span>a) mchain[i<span class="op">+</span><span class="dv">1</span>]=r <span class="cf">else</span> mchain[i<span class="op">+</span><span class="dv">1</span>]=mchain[i]
}
<span class="co">#  return(c(k,mchain))</span>
<span class="kw">return</span>(mchain)
}
<span class="kw">set.seed</span>(<span class="dv">123</span>)
sigma =<span class="st"> </span><span class="dv">8</span>
<span class="co">#sigma of the proposal distributio</span>
N=<span class="dv">5000</span>
n=<span class="dv">1000</span>

LMcauchy &lt;-<span class="st"> </span><span class="cf">function</span>(x,theta,eta){
<span class="kw">return</span>(<span class="dv">1</span><span class="op">/</span>theta<span class="op">/</span>pi<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>((x<span class="op">-</span>eta)<span class="op">/</span>theta)<span class="op">^</span><span class="dv">2</span>))
}
theta=<span class="dv">1</span>
eta=<span class="dv">0</span>

MCchaincauchy &lt;-<span class="st"> </span><span class="kw">MCMC</span>(N,<span class="dv">1</span>,<span class="dv">0</span>,sigma,<span class="dv">0</span>,LMcauchy)
<span class="co">#accrptation rate : 30%</span>
<span class="co">#MCchaincauchy[1]</span>
<span class="kw">hist</span>(MCchaincauchy[(n<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N],<span class="dt">freq =</span> <span class="ot">FALSE</span>,<span class="dt">main=</span><span class="st">&quot;MC chain of cauchy&quot;</span>)
x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="kw">min</span>(MCchaincauchy[(n<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N]),<span class="kw">max</span>(MCchaincauchy[(n<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N]),<span class="dt">length=</span><span class="dv">1000</span>)
<span class="kw">lines</span>(x,<span class="kw">LMcauchy</span>(x,<span class="dv">1</span>,<span class="dv">0</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xx &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>)  
MC_deciles &lt;-<span class="st"> </span><span class="kw">quantile</span>(MCchaincauchy[(n<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N],xx)
Th_deciles &lt;-<span class="st"> </span><span class="kw">qcauchy</span>(xx)
ans &lt;-<span class="st"> </span><span class="kw">rbind</span>(MC_deciles,Th_deciles,<span class="kw">abs</span>(Th_deciles<span class="op">-</span>MC_deciles))
<span class="kw">rownames</span>(ans)[<span class="dv">3</span>] &lt;-<span class="st"> &quot;differ&quot;</span>
ans</code></pre></div>
<pre><code>##                   10%         20%         30%         40%        50%
## MC_deciles -2.9353678 -1.45464343 -0.80573171 -0.38707703 -0.1135152
## Th_deciles -3.0776835 -1.37638192 -0.72654253 -0.32491970  0.0000000
## differ      0.1423157  0.07826151  0.07918919  0.06215733  0.1135152
##                  60%       70%       80%       90%
## MC_deciles 0.1961879 0.5953806 1.1740178 2.6918223
## Th_deciles 0.3249197 0.7265425 1.3763819 3.0776835
## differ     0.1287318 0.1311620 0.2023641 0.3858612</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qqplot</span>(<span class="kw">qcauchy</span>(<span class="kw">ppoints</span>(N<span class="op">-</span>n)),MCchaincauchy[(n<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N])
<span class="kw">qqline</span>(MCchaincauchy[(n<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N],<span class="dt">distribution =</span> qcauchy)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="q4-2" class="section level2">
<h2>Q4</h2>
<p>9.6 Rao [220, Sec. 5g] presented an example on genetic linkage of 197 animals in four categories (also discussed in [67, 106, 171, 266]). The group sizes are (125,18,20,34). Assume that the probabilities of the corresponding multinomial distribution are</p>
<p><span class="math inline">\((\frac1 2 + \frac?? 4, \frac{1-??} 4 , \frac{1-??} 4 , \frac?? 4)\)</span>.</p>
<p>Estimate the posterior distribution of ?? given the observed sample, using one of the methods in this chapter.</p>
</div>
<div id="a4-2" class="section level2">
<h2>A4</h2>
<p>MCMC estimates:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#9.6</span>
<span class="co">#It is obvious that theta belongs to [0,1]</span>
<span class="co">#i chooose the uniform as the prior distrubution</span>
<span class="co">#</span>
<span class="co">#(125,18,20,34)</span>
<span class="co">#</span>

<span class="kw">set.seed</span>(<span class="dv">214</span>)
CMD &lt;-<span class="st"> </span><span class="cf">function</span>(theta){
<span class="co">#return the probabilities vector of the corresponding multinomial distribution </span>
<span class="cf">if</span>(theta <span class="op">&gt;</span><span class="dv">1</span>) <span class="kw">return</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))
<span class="cf">if</span>(theta <span class="op">&lt;</span><span class="dv">0</span>) <span class="kw">return</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))
<span class="kw">return</span>(<span class="kw">c</span>(<span class="fl">0.5</span><span class="op">+</span>theta<span class="op">/</span><span class="dv">4</span>,(<span class="dv">1</span><span class="op">-</span>theta)<span class="op">/</span><span class="dv">4</span>,(<span class="dv">1</span><span class="op">-</span>theta)<span class="op">/</span><span class="dv">4</span>,theta<span class="op">/</span><span class="dv">4</span>))
}

LMCMD &lt;-<span class="st"> </span><span class="cf">function</span>(r,data){
p &lt;-<span class="st"> </span><span class="kw">CMD</span>(r)
<span class="kw">return</span>(p[<span class="dv">1</span>]<span class="op">^</span>data[<span class="dv">1</span>]<span class="op">*</span>p[<span class="dv">2</span>]<span class="op">^</span>data[<span class="dv">2</span>]<span class="op">*</span>p[<span class="dv">3</span>]<span class="op">^</span>data[<span class="dv">3</span>]<span class="op">*</span>p[<span class="dv">4</span>]<span class="op">^</span>data[<span class="dv">4</span>])
}

MCMC2 &lt;-<span class="st"> </span><span class="cf">function</span>(N,data,<span class="dt">startx=</span><span class="fl">0.5</span>){
mchain &lt;-<span class="st"> </span><span class="kw">numeric</span>(N) 
mchain[<span class="dv">1</span>] =<span class="st"> </span>startx
<span class="co">#k=0</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(N<span class="op">-</span><span class="dv">1</span>)){
r &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)
a =<span class="st"> </span><span class="kw">LMCMD</span>(r,data)  <span class="op">/</span><span class="st"> </span><span class="kw">LMCMD</span>(mchain[i],data)
nr &lt;-<span class="kw">runif</span>(<span class="dv">1</span>)
<span class="cf">if</span>(nr<span class="op">&lt;</span>a) mchain[i<span class="op">+</span><span class="dv">1</span>]=r <span class="cf">else</span> mchain[i<span class="op">+</span><span class="dv">1</span>]=mchain[i]
}
<span class="kw">return</span>(mchain)
}

data &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">125</span>,<span class="dv">18</span>,<span class="dv">20</span>,<span class="dv">34</span>)
mchain2 &lt;-<span class="st"> </span><span class="kw">MCMC2</span>(N,data,<span class="fl">0.5</span>)
<span class="co"># PS: acceptation rate is 16%</span>
achain &lt;-<span class="st"> </span>mchain2[<span class="dv">1001</span><span class="op">:</span>N]
<span class="kw">hist</span>(achain)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(achain)</code></pre></div>
<pre><code>## [1] 0.6248848</code></pre>
</div>
<div id="h8-a-18033-2018-11-30" class="section level2">
<h2>H8 A-18033-2018-11-30</h2>
</div>
<div id="q1-6" class="section level2">
<h2>Q1</h2>
<p>11.6 Write a function to compute the cdf of the Cauchy distribution, which has density <span class="math display">\[\frac{1}{\theta\pi(1+[(x-\eta)/\theta]^2),-\infty&lt;x&lt;\infty}\]</span>, where <span class="math inline">\(\theta&gt;0\)</span>. Compare your results to the results from the R function pcauchy. (Also see the source code in pcauchy.c.)</p>
</div>
<div id="a1-6" class="section level2">
<h2>A1</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">LMF &lt;-<span class="cf">function</span>(y,theta,eta){
  <span class="co">#theta : scale parameter</span>
  <span class="co">#eta : the location parameter</span>
  <span class="dv">1</span><span class="op">/</span>(theta<span class="op">*</span><span class="fl">3.141592653</span><span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>((y<span class="op">-</span>eta)<span class="op">/</span>theta)<span class="op">^</span><span class="dv">2</span>))
}
<span class="co"># the cauchy pdf</span>

pdf &lt;-<span class="cf">function</span>(x,theta,eta,<span class="dt">lower.tail=</span><span class="ot">TRUE</span>){
  <span class="cf">if</span>(lower.tail) result&lt;-<span class="kw">integrate</span>(LMF,<span class="dt">lower =</span> <span class="op">-</span><span class="ot">Inf</span>,<span class="dt">upper =</span> x,<span class="dt">rel.tol=</span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.25</span>,<span class="dt">theta=</span>theta,<span class="dt">eta=</span>eta)
  <span class="cf">else</span> result&lt;-<span class="kw">integrate</span>(LMF,<span class="dt">lower =</span> x,<span class="dt">upper =</span> <span class="ot">Inf</span>,<span class="dt">rel.tol=</span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.25</span>,<span class="dt">theta=</span>theta,<span class="dt">eta=</span>eta)
  <span class="kw">return</span>(result<span class="op">$</span>value)
}
<span class="kw">pdf</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dt">lower.tail =</span> F )</code></pre></div>
<pre><code>## [1] 0.3524164</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pcauchy</span>(<span class="dv">2</span>,<span class="dt">location =</span> <span class="dv">1</span>,<span class="dt">scale =</span> <span class="dv">2</span>,<span class="dt">lower.tail =</span> F)</code></pre></div>
<pre><code>## [1] 0.3524164</code></pre>
<p>The result is same</p>
</div>
<div id="q2-exercises-3" class="section level2">
<h2>Q2 Exercises 3</h2>
<ul>
<li><p>A-B-O blood type problem</p></li>
<li><p>Let the three alleles be A, B, and O.</p></li>
</ul>
<table>
<caption>
Comparation of them
</caption>
<tbody>
<tr>
<td style="text-align:left;">
Genotype
</td>
<td style="text-align:center;">
AA
</td>
<td style="text-align:center;">
BB
</td>
<td style="text-align:center;">
OO
</td>
<td style="text-align:center;">
AO
</td>
<td style="text-align:center;">
BO
</td>
<td style="text-align:center;">
AB
</td>
<td style="text-align:center;">
Sum
</td>
</tr>
<tr>
<td style="text-align:left;">
Frequency
</td>
<td style="text-align:center;">
p2
</td>
<td style="text-align:center;">
q2
</td>
<td style="text-align:center;">
r2
</td>
<td style="text-align:center;">
2pr
</td>
<td style="text-align:center;">
2qr
</td>
<td style="text-align:center;">
2pq
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Count
</td>
<td style="text-align:center;">
nAA
</td>
<td style="text-align:center;">
nBB
</td>
<td style="text-align:center;">
nOO
</td>
<td style="text-align:center;">
nAO
</td>
<td style="text-align:center;">
nBO
</td>
<td style="text-align:center;">
nAB
</td>
<td style="text-align:center;">
n
</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Observed data: <span class="math inline">\(n_{A\cdot}=n_{AA}+n_{AO}=28\)</span> (A-type), <span class="math inline">\(n_{B\cdot}=n_{BB}+n_{BO}=24\)</span> (B-type), <span class="math inline">\(n_{OO}=41\)</span> (O-type), <span class="math inline">\(n_{AB}=70\)</span> (AB-type).</p></li>
<li><p>Use EM algorithm to solve MLE of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> (consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>).</p></li>
<li><p>Record the maximum likelihood values in M-steps, are they increasing?</p></li>
</ul>
</div>
<div id="a2-4" class="section level2">
<h2>A2</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages(&quot;nloptr&quot;)</span>
<span class="kw">library</span>(nloptr)</code></pre></div>
<pre><code>## Warning: 程辑包'nloptr'是用R版本3.5.2 来建造的</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># mle</span>
logL &lt;-<span class="st"> </span><span class="cf">function</span>(x,xpart,n.A,n.B,nOO,nAB) {
  <span class="co">#x[1] p</span>
  <span class="co">#x[2] q</span>
  <span class="co">#xpart[1] p0</span>
  <span class="co">#xpart[2] q0</span>
  r1&lt;-<span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(xpart)
  nAA&lt;-n.A<span class="op">*</span>xpart[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(xpart[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>xpart[<span class="dv">1</span>]<span class="op">*</span>r1)
  nBB&lt;-n.B<span class="op">*</span>xpart[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(xpart[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>xpart[<span class="dv">2</span>]<span class="op">*</span>r1)
  r&lt;-<span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(x)
  <span class="kw">return</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>nAA<span class="op">*</span><span class="kw">log</span>(x[<span class="dv">1</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>nBB<span class="op">*</span><span class="kw">log</span>(x[<span class="dv">2</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>nOO<span class="op">*</span><span class="kw">log</span>(r)<span class="op">-</span>
<span class="st">           </span>(n.A<span class="op">-</span>nAA)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>x[<span class="dv">1</span>]<span class="op">*</span>r)<span class="op">-</span>(n.B<span class="op">-</span>nBB)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>x[<span class="dv">2</span>]<span class="op">*</span>r)<span class="op">-</span>nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>x[<span class="dv">1</span>]<span class="op">*</span>x[<span class="dv">2</span>]))
}

<span class="co"># constraint function </span>
limitx &lt;-<span class="st"> </span><span class="cf">function</span>(x,xpart,n.A,n.B,nOO,nAB) {
  <span class="kw">return</span>(<span class="kw">sum</span>(x)<span class="op">-</span><span class="fl">0.999999</span>)
}

opts &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;algorithm&quot;</span>=<span class="st">&quot;NLOPT_LN_COBYLA&quot;</span>,
             <span class="st">&quot;xtol_rel&quot;</span>=<span class="fl">1.0e-8</span>)
EMmle&lt;-<span class="ot">NULL</span>
r&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)
r&lt;-<span class="kw">rbind</span>(r,<span class="kw">c</span>(<span class="fl">0.2</span>,<span class="fl">0.2</span>))
<span class="co"># first p0 and q0</span>
j&lt;-<span class="dv">2</span>
<span class="cf">while</span> (<span class="kw">sum</span>((r[j,]<span class="op">-</span>r[j<span class="op">-</span><span class="dv">1</span>,])<span class="op">^</span><span class="dv">2</span>)<span class="op">&gt;</span><span class="fl">1e-10</span>) {
  res &lt;-<span class="st"> </span><span class="kw">nloptr</span>( <span class="dt">x0=</span><span class="kw">c</span>(<span class="fl">0.2</span>,<span class="fl">0.2</span>),
                 <span class="dt">eval_f=</span>logL,
                 <span class="dt">lb =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">ub =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), 
                 <span class="dt">eval_g_ineq =</span>limitx, 
                 <span class="dt">opts =</span> opts, <span class="dt">xpart=</span>r[j,],<span class="dt">n.A=</span><span class="dv">28</span>,<span class="dt">n.B=</span><span class="dv">24</span>,<span class="dt">nOO=</span><span class="dv">41</span>,<span class="dt">nAB=</span><span class="dv">70</span> )
  j&lt;-j<span class="op">+</span><span class="dv">1</span>
  r&lt;-<span class="kw">rbind</span>(r,res<span class="op">$</span>solution)
  EMmle&lt;-<span class="kw">c</span>(EMmle,<span class="kw">logL</span>(<span class="dt">x=</span>r[j,],<span class="dt">xpart=</span>r[j<span class="op">-</span><span class="dv">1</span>,],<span class="dt">n.A=</span><span class="dv">28</span>,<span class="dt">n.B=</span><span class="dv">24</span>,<span class="dt">nOO=</span><span class="dv">41</span>,<span class="dt">nAB=</span><span class="dv">70</span>))
}
<span class="co">#Answer:</span>
r[<span class="kw">nrow</span>(r),<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</code></pre></div>
<pre><code>## [1] 0.3273433 0.3104259</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#EM:</span>
r</code></pre></div>
<pre><code>##           [,1]      [,2]
## [1,] 0.0000000 0.0000000
## [2,] 0.2000000 0.2000000
## [3,] 0.3128834 0.2988606
## [4,] 0.3252817 0.3088035
## [5,] 0.3270424 0.3101899
## [6,] 0.3272999 0.3103919
## [7,] 0.3273377 0.3104216
## [8,] 0.3273433 0.3104259</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># negetive log likelihood</span>
EMmle</code></pre></div>
<pre><code>## [1] 276.5216 282.9444 283.7928 283.9155 283.9335 283.9362</code></pre>
</div>
<div id="h9-a-18033-2018-12-07" class="section level2">
<h2>H9 A-18033-2018-12-07</h2>
</div>
<div id="q1-exercises-3-p204" class="section level2">
<h2>Q1 Exercises 3 P204</h2>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list: formulas &lt;- list( mpg ~ disp, mpg ~ I(1 / disp), mpg ~ disp + wt, mpg ~ I(1 / disp) + wt ) # Answer I use lmloop to save the answer of loops</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attach</span>(mtcars)
formulas &lt;-<span class="st"> </span><span class="kw">list</span>( mpg <span class="op">~</span><span class="st"> </span>disp, 
    mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp), 
    mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,
    mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt 
)
<span class="co">#Loops</span>
lmloop &lt;-<span class="st"> </span><span class="kw">list</span>()
<span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(formulas)) {
  lmloop[[k]] &lt;-<span class="st"> </span><span class="kw">lm</span>(formulas[[k]]) 
}
lmloop</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[k]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[k]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[k]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[k]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Lapply</span>
<span class="kw">lapply</span>(formulas,lm)</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#same answers</span></code></pre></div>
</div>
<div id="q2-exercises-4-p204" class="section level2">
<h2>Q2 Exercises 4 P204</h2>
<p>Fit the model mpg ~ disp to each of the bootstrap replicates of mtcars in the list below by using a for loop and lapply(). Can you do it without an anonymous function? bootstraps &lt;- lapply(1:10, function(i) { rows &lt;- sample(1:nrow(mtcars), rep = TRUE) mtcars[rows, ] })</p>
</div>
<div id="a2-5" class="section level2">
<h2>A2</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">123</span>)
<span class="co">#follow the question:</span>
bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {
  rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)
  mtcars[rows, ] })

<span class="co">#Loops</span>
lmboots&lt;-<span class="kw">list</span>()
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(bootstraps)){
  lmboots[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg<span class="op">~</span>disp,<span class="dt">data =</span>bootstraps[[i]])
}
lmboots</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     30.0287      -0.0434  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.44060     -0.03799  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.92155     -0.03918  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.10046     -0.04044  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.76035     -0.04505  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.49804     -0.04948  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.77795     -0.04433  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.23589     -0.04872  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.47647     -0.03299  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.61819     -0.03719</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Lapply</span>
<span class="kw">set.seed</span>(<span class="dv">123</span>)
<span class="kw">lapply</span>(bootstraps,lm,<span class="dt">formula=</span>mpg<span class="op">~</span>disp)</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     30.0287      -0.0434  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.44060     -0.03799  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.92155     -0.03918  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.10046     -0.04044  
## 
## 
## [[5]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.76035     -0.04505  
## 
## 
## [[6]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.49804     -0.04948  
## 
## 
## [[7]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.77795     -0.04433  
## 
## 
## [[8]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.23589     -0.04872  
## 
## 
## [[9]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.47647     -0.03299  
## 
## 
## [[10]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.61819     -0.03719</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#same seed ,same answer</span></code></pre></div>
</div>
<div id="q3-exercises-5-p204" class="section level2">
<h2>Q3 Exercises 5 P204</h2>
<p>For each model in the previous two exercises,extract <span class="math inline">\(R^2\)</span> using the function below. rsq &lt;- function(mod) summary(mod)$r.squared</p>
</div>
<div id="a3-4" class="section level2">
<h2>A3</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#From the question: </span>
rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary.lm</span>(mod)<span class="op">$</span>r.squared
<span class="co">#Q1 Exercises 3</span>
<span class="co">#Loops</span>
rsqloopsQ3 &lt;-<span class="st"> </span><span class="ot">NULL</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(formulas)) {
 rsqloopsQ3[i] &lt;-<span class="st"> </span><span class="kw">rsq</span>(<span class="kw">lm</span>(formulas[[i]]))
}
rsqloopsQ3</code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#lapply</span>
<span class="kw">lapply</span>(<span class="kw">lapply</span>(formulas,lm),rsq)</code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Q2 Exercises 4</span>
<span class="co">#Loops</span>
rsqloopsQ4 &lt;-<span class="st"> </span><span class="ot">NULL</span>
<span class="kw">set.seed</span>(<span class="dv">123</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(bootstraps)){
 rsqloopsQ4[i] &lt;-<span class="st"> </span><span class="kw">rsq</span>(<span class="kw">lm</span>(mpg<span class="op">~</span>disp,<span class="dt">data =</span>bootstraps[[i]]))
}
rsqloopsQ4</code></pre></div>
<pre><code>##  [1] 0.7475099 0.7179526 0.7571433 0.6921848 0.8488426 0.7702828 0.7491175
##  [8] 0.7843995 0.6779810 0.7887093</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#lapply</span>
<span class="kw">set.seed</span>(<span class="dv">123</span>)
<span class="kw">lapply</span>(<span class="kw">lapply</span>(bootstraps,lm,<span class="dt">formula=</span>mpg<span class="op">~</span>disp),rsq)</code></pre></div>
<pre><code>## [[1]]
## [1] 0.7475099
## 
## [[2]]
## [1] 0.7179526
## 
## [[3]]
## [1] 0.7571433
## 
## [[4]]
## [1] 0.6921848
## 
## [[5]]
## [1] 0.8488426
## 
## [[6]]
## [1] 0.7702828
## 
## [[7]]
## [1] 0.7491175
## 
## [[8]]
## [1] 0.7843995
## 
## [[9]]
## [1] 0.677981
## 
## [[10]]
## [1] 0.7887093</code></pre>
</div>
<div id="q4-exercises-3-p213" class="section level2">
<h2>Q4 Exercises 3 P213</h2>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial. trials &lt;- replicate( 100, t.test(rpois(10, 10), rpois(7, 10)), simplify = FALSE ) Extra challenge: get rid of the anonymous function by using [[ directly.</p>
</div>
<div id="a4-3" class="section level2">
<h2>A4</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#sapply</span>
trials &lt;-<span class="st"> </span><span class="kw">replicate</span>( <span class="dv">100</span>, <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)), <span class="dt">simplify =</span> <span class="ot">FALSE</span> )
p_value&lt;-<span class="cf">function</span>(mod) mod<span class="op">$</span>p.value
<span class="kw">sapply</span>(trials, p_value)</code></pre></div>
<pre><code>##   [1] 9.813226e-01 1.619096e-05 6.242135e-01 6.693526e-01 5.677105e-01
##   [6] 6.610740e-01 5.951636e-01 5.005347e-01 4.763110e-01 3.429965e-01
##  [11] 8.155394e-01 7.197238e-01 1.244336e-01 2.229164e-01 1.113099e-02
##  [16] 4.625765e-01 6.515865e-01 1.658793e-01 9.342672e-01 8.011934e-01
##  [21] 4.627657e-01 5.927934e-01 2.929669e-01 5.737967e-01 3.451537e-02
##  [26] 2.739138e-01 2.656151e-01 8.196695e-01 6.647355e-01 8.056529e-01
##  [31] 5.060850e-01 7.106543e-01 2.321066e-01 1.106223e-01 5.459279e-01
##  [36] 1.865470e-02 2.433776e-01 2.688851e-01 9.819256e-01 4.940184e-01
##  [41] 3.268275e-01 8.000439e-01 9.822499e-01 1.936454e-01 7.390101e-01
##  [46] 3.888930e-02 4.350424e-01 7.434339e-02 5.787441e-01 4.864951e-01
##  [51] 1.476288e-01 5.524909e-01 7.129280e-01 8.683479e-03 9.053256e-02
##  [56] 4.415463e-01 4.955063e-01 1.745328e-01 6.615399e-01 4.479199e-01
##  [61] 2.885849e-01 3.028567e-02 1.018907e-01 1.811861e-02 6.376441e-01
##  [66] 1.408742e-02 9.008128e-02 4.515933e-01 8.703291e-01 7.250768e-01
##  [71] 8.183571e-01 8.465036e-01 8.786838e-01 1.651543e-01 3.951569e-01
##  [76] 1.754280e-01 3.649865e-01 7.224226e-02 6.565152e-01 9.946559e-01
##  [81] 3.715952e-01 8.424336e-02 4.549887e-01 8.530113e-01 1.970777e-01
##  [86] 2.298117e-01 1.148832e-01 7.769502e-01 4.934348e-01 3.526049e-01
##  [91] 2.036013e-01 8.838914e-01 6.474880e-02 4.089082e-01 5.780132e-01
##  [96] 8.011408e-01 5.956061e-01 9.266689e-01 9.923205e-02 1.763972e-01</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#[[ directly</span>
<span class="co">#??</span></code></pre></div>
</div>
<div id="q5-exercises-6-in-page-214" class="section level2">
<h2>Q5 Exercises 6 in page 214</h2>
<p>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
</div>
<div id="a5" class="section level2">
<h2>A5</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Mapvapplay&lt;-<span class="cf">function</span> (f,n,type, ...) {  
  <span class="co">#n:the length of output </span>
  f &lt;-<span class="st"> </span><span class="kw">match.fun</span>(f)
  fM=<span class="kw">Map</span>(f, ...)
  <span class="cf">if</span>(type<span class="op">==</span><span class="st">&quot;numeric&quot;</span>)  <span class="kw">return</span>(<span class="kw">vapply</span>(fM,cbind,<span class="kw">numeric</span>(n)))
  <span class="cf">else</span> <span class="cf">if</span> (type<span class="op">==</span><span class="st">&quot;character&quot;</span>) <span class="kw">return</span>(<span class="kw">vapply</span>(fM,cbind,<span class="kw">character</span>(n)))
  <span class="cf">else</span> <span class="cf">if</span> (type<span class="op">==</span><span class="st">&quot;complex&quot;</span>) <span class="kw">return</span>(<span class="kw">vapply</span>(fM,cbind,<span class="kw">complex</span>(n)))
  <span class="cf">else</span> <span class="cf">if</span> (type<span class="op">==</span><span class="st">&quot;logical&quot;</span>) <span class="kw">return</span>(<span class="kw">vapply</span>(fM,cbind,<span class="kw">logical</span>(n)))
}

<span class="co">#examples :Q3</span>
rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary.lm</span>(mod)<span class="op">$</span>r.squared
<span class="kw">Mapvapplay</span>(rsq,<span class="dv">1</span>,<span class="st">&quot;numeric&quot;</span>,<span class="kw">lapply</span>(formulas,lm))</code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#example 2</span>
comparexy &lt;-<span class="st"> </span><span class="cf">function</span>(x,y) <span class="kw">return</span>(x<span class="op">&lt;</span>y)
x&lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">2</span><span class="op">:</span><span class="dv">11</span>,<span class="dv">3</span><span class="op">:</span><span class="dv">12</span>)
y&lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">10</span><span class="op">:</span><span class="dv">1</span>,<span class="dv">11</span><span class="op">:</span><span class="dv">2</span>,<span class="dv">12</span><span class="op">:</span><span class="dv">3</span>)
<span class="kw">Mapvapplay</span>(comparexy,<span class="dv">10</span>,<span class="st">&quot;logical&quot;</span>,x,y)</code></pre></div>
<pre><code>##        [,1]  [,2]  [,3]
##  [1,]  TRUE  TRUE  TRUE
##  [2,]  TRUE  TRUE  TRUE
##  [3,]  TRUE  TRUE  TRUE
##  [4,]  TRUE  TRUE  TRUE
##  [5,]  TRUE  TRUE  TRUE
##  [6,] FALSE FALSE FALSE
##  [7,] FALSE FALSE FALSE
##  [8,] FALSE FALSE FALSE
##  [9,] FALSE FALSE FALSE
## [10,] FALSE FALSE FALSE</code></pre>
</div>
<div id="h10-a-18033-12-14" class="section level2">
<h2>H10 A-18033-12-14</h2>
</div>
<div id="q1-exercise-4" class="section level2">
<h2>Q1 exercise 4</h2>
<p>Make a faster version of chisq.test() that only computes the chi-square test statistic when the input is two numeric vectors with no missing values. You can try simplifying chisq.test() or by coding from the mathematical definition (<a href="http://en" class="uri">http://en</a>. wikipedia.org/wiki/Pearson%27s_chi-squared_test).</p>
</div>
<div id="a1-7" class="section level2">
<h2>A1</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(microbenchmark)</code></pre></div>
<pre><code>## Warning: 程辑包'microbenchmark'是用R版本3.5.2 来建造的</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fastchisq.test&lt;-<span class="cf">function</span>(x,y){  
  <span class="co">#Pearson's Chi-squared test</span>
  <span class="co">#input two numeric vectors x,y</span>
  <span class="co">#x,y should have same length</span>
  <span class="co">#computes the chi-square test statistic</span>
  X &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y) 
  n&lt;-<span class="kw">sum</span>(<span class="kw">c</span>(x,y))
  rs &lt;-<span class="kw">rowSums</span>(X)
  cs &lt;-<span class="kw">colSums</span>(X)
  np &lt;-rs <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(cs)<span class="op">/</span>n
  <span class="kw">return</span>(<span class="kw">sum</span>((X<span class="op">-</span>np)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>np))
}
x&lt;-<span class="kw">c</span>(<span class="dv">42</span>,<span class="dv">13</span>,<span class="dv">24</span>)
y&lt;-<span class="kw">c</span>(<span class="dv">111</span>,<span class="dv">50</span>,<span class="dv">50</span>)  
<span class="kw">fastchisq.test</span>(x,y)        </code></pre></div>
<pre><code>## [1] 2.396744</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test</span>(<span class="kw">rbind</span>(x,y))</code></pre></div>
<pre><code>## 
##  Pearson's Chi-squared test
## 
## data:  rbind(x, y)
## X-squared = 2.3967, df = 2, p-value = 0.3017</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">microbenchmark</span>(<span class="dt">t1=</span><span class="kw">fastchisq.test</span>(x,y),<span class="dt">t2=</span><span class="kw">chisq.test</span>(<span class="kw">rbind</span>(x,y)))  </code></pre></div>
<pre><code>## Unit: microseconds
##  expr     min      lq     mean  median      uq       max neval
##    t1  26.257  28.080 161.7659  32.821  33.733 13085.551   100
##    t2 137.482 139.123 143.5687 140.217 142.223   261.836   100</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#it is obivous that fastchisq.test is faster</span></code></pre></div>
</div>
<div id="q2-exercise-5" class="section level2">
<h2>Q2 exercise 5</h2>
<p>Can you make a faster version of table() for the case of an input of two integer vectors with no missing values? Can you use it to speed up your chi-square test?</p>
</div>
<div id="a2-6" class="section level2">
<h2>A2</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fasttable&lt;-<span class="cf">function</span>(...,<span class="dt">dnn =</span> <span class="kw">list.names</span>(...),<span class="dt">deparse.level =</span> <span class="dv">1</span>){
  <span class="co">#input: of two integer vectors</span>
  <span class="co">#two integer vectors should have same length</span>
  <span class="co">#output:  </span>
  <span class="co">#sort by quickSort</span>
  list.names &lt;-<span class="st"> </span><span class="cf">function</span>(...) {
    l &lt;-<span class="st"> </span><span class="kw">as.list</span>(<span class="kw">substitute</span>(<span class="kw">list</span>(...)))[<span class="op">-</span>1L]
    nm &lt;-<span class="st"> </span><span class="kw">names</span>(l)
    fixup &lt;-<span class="st"> </span><span class="cf">if</span> (<span class="kw">is.null</span>(nm)) 
    <span class="kw">seq_along</span>(l)
    <span class="cf">else</span> nm <span class="op">==</span><span class="st"> &quot;&quot;</span>
    dep &lt;-<span class="st"> </span><span class="kw">vapply</span>(l[fixup], <span class="cf">function</span>(x) <span class="cf">switch</span>(deparse.level <span class="op">+</span><span class="st"> </span>
<span class="st">          </span><span class="dv">1</span>, <span class="st">&quot;&quot;</span>, <span class="cf">if</span> (<span class="kw">is.symbol</span>(x)) <span class="kw">as.character</span>(x) <span class="cf">else</span> <span class="st">&quot;&quot;</span>, 
            <span class="kw">deparse</span>(x, <span class="dt">nlines =</span> <span class="dv">1</span>)[1L]), <span class="st">&quot;&quot;</span>)
    <span class="cf">if</span> (<span class="kw">is.null</span>(nm)) 
      dep
    <span class="cf">else</span> {
      nm[fixup] &lt;-<span class="st"> </span>dep
      nm
    }
  }
  args &lt;-<span class="st"> </span><span class="kw">list</span>(...)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(args)) 
    <span class="kw">stop</span>(<span class="st">&quot;nothing to tabulate&quot;</span>)
  <span class="cf">if</span> (<span class="kw">length</span>(args) <span class="op">==</span><span class="st"> </span>1L <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.list</span>(args[[1L]])) {
    args &lt;-<span class="st"> </span>args[[1L]]
    <span class="cf">if</span> (<span class="kw">length</span>(dnn) <span class="op">!=</span><span class="st"> </span><span class="kw">length</span>(args)) 
    dnn &lt;-<span class="st"> </span><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(argn &lt;-<span class="st"> </span><span class="kw">names</span>(args))) 
    argn
    <span class="cf">else</span> <span class="kw">paste</span>(dnn[1L], <span class="kw">seq_along</span>(args), <span class="dt">sep =</span> <span class="st">&quot;.&quot;</span>)
  }
  bin &lt;-<span class="st"> </span>0L
  lens &lt;-<span class="st"> </span><span class="ot">NULL</span>
  dims &lt;-<span class="st"> </span><span class="kw">integer</span>()
  pd &lt;-<span class="st"> </span>1L
  dn &lt;-<span class="st"> </span><span class="ot">NULL</span>
  <span class="cf">for</span> (a <span class="cf">in</span> args) {
    <span class="cf">if</span> (<span class="kw">is.null</span>(lens))   lens &lt;-<span class="st"> </span><span class="kw">length</span>(a)
    <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">length</span>(a) <span class="op">!=</span><span class="st"> </span>lens) 
    <span class="kw">stop</span>(<span class="st">&quot;all arguments must have the same length&quot;</span>)
    fact.a &lt;-<span class="st"> </span><span class="kw">is.factor</span>(a)
    <span class="cf">if</span> (<span class="op">!</span>fact.a) {
      a0 &lt;-<span class="st"> </span>a
      a &lt;-<span class="st"> </span><span class="kw">factor</span>(a)
    }
    ll &lt;-<span class="st"> </span><span class="kw">levels</span>(a)
    a &lt;-<span class="st"> </span><span class="kw">as.integer</span>(a)
    nl &lt;-<span class="st"> </span><span class="kw">length</span>(ll)
    dims &lt;-<span class="st"> </span><span class="kw">c</span>(dims, nl)
    dn &lt;-<span class="st"> </span><span class="kw">c</span>(dn, <span class="kw">list</span>(ll))
    bin &lt;-<span class="st"> </span>bin <span class="op">+</span><span class="st"> </span>pd <span class="op">*</span><span class="st"> </span>(a <span class="op">-</span><span class="st"> </span>1L)
    pd &lt;-<span class="st"> </span>pd <span class="op">*</span><span class="st"> </span>nl
 }
  <span class="kw">names</span>(dn) &lt;-<span class="st"> </span>dnn
  bin &lt;-<span class="st"> </span>bin[<span class="op">!</span><span class="kw">is.na</span>(bin)]
  <span class="cf">if</span> (<span class="kw">length</span>(bin)) bin &lt;-<span class="st"> </span>bin <span class="op">+</span><span class="st"> </span>1L
  y &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="kw">tabulate</span>(bin, pd), dims, <span class="dt">dimnames =</span> dn)
  <span class="kw">class</span>(y) &lt;-<span class="st"> &quot;table&quot;</span>
  y
}
<span class="co"># I delete all useless judgement statement</span>

x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">100</span>),<span class="kw">rep</span>(<span class="dv">2</span>,<span class="dv">100</span>),<span class="kw">rep</span>(<span class="dv">3</span>,<span class="dv">100</span>),<span class="kw">rep</span>(<span class="dv">4</span>,<span class="dv">100</span>),<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">100</span>))
y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">100</span>))
<span class="kw">fasttable</span>(x,y)</code></pre></div>
<pre><code>##    y
## x    1  2  3  4  5
##   1 20 20 20 20 20
##   2 20 20 20 20 20
##   3 20 20 20 20 20
##   4 20 20 20 20 20
##   5 20 20 20 20 20</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(x,y)</code></pre></div>
<pre><code>##    y
## x    1  2  3  4  5
##   1 20 20 20 20 20
##   2 20 20 20 20 20
##   3 20 20 20 20 20
##   4 20 20 20 20 20
##   5 20 20 20 20 20</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">microbenchmark</span>(<span class="dt">t1=</span><span class="kw">fasttable</span>(x,y),<span class="dt">t2=</span><span class="kw">table</span>(x,y))    </code></pre></div>
<pre><code>## Unit: microseconds
##  expr     min      lq     mean  median       uq     max neval
##    t1 473.711 478.816 492.9798 488.298 495.7730 635.625   100
##    t2 486.839 491.944 509.0036 501.061 510.7245 685.950   100</code></pre>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
